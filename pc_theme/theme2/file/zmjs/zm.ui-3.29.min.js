(function(){var a={},b=[];zm.Key={bindDocEscape:function(c,d){a[c]=d},queueDocEscape:function(c){b.push(c)},dequeueDocEscape:function(d){var c=zm.inArray(d,b);b.splice(c,1)}};zm(document).keyup(function(c){if(c.keyCode==27){var d=a[b.pop()];zm.isFunction(d)&&d()}})})();zm.install("emotions",{renderEmotions:function(a){for(var c=0;c<this.size();c++){var b=zm(this[c]).html();b=zm.renderEmotions(b,a);zm(this[c]).html(b)}return this},attachEmoButtons:function(d,a){zmEmotion.init();for(var c=0;c<this.size();c++){if(!zm.data(this[c],"emotions.attached")){a&&zm("#"+(d||"")+this[c].getAttribute("rel").substr(4)).data("emotions.options",a);zm(this[c]).click(function(){var i=this,f=i.getAttribute("rel");if(!f){i=i.parentNode}f=i.getAttribute("rel");d=d||"";var h=d.charAt(0);if(h!="."&&h!="#"){d="#"+d}var g=zm(d+(f&&f.substr(4)))[0];if(!g||g.disabled){return false}var j=zm("#zmemotion");zmEmotion.button&&zm(zmEmotion.button).removeClass("sel");zmEmotion.button=i;if(zmEmotion.currentEditor===null||zmEmotion.currentEditor!=g){zm.plugins.emotions.show=false}zmEmotion.currentEditor=g;if(zm.plugins.emotions.show){zm.plugins.emotions.show=false;zmEmotion.close()}else{zm.plugins.emotions.show=true;if(a&&zm.isFunction(a.beforeShow)){a.beforeShow.call(j,j)}j.show();zmEmotion.setPosition(i,a);zm(i).addClass("sel")}return false}).attr("tabIndex",0);var b=this[c];if(a){a.windowScroll&&zm(window).scroll(function(){zmEmotion.setPosition(b,a)});a.windowResize&&zm(window).resize(function(){zmEmotion.setPosition(b,a)});a.cssPosition&&zm.data(b,"emotions.position",a.cssPosition);a.offset&&zm.data(b,"emotions.offset",a.offset)}zm("#zmemotion").clickOutsideWith(b);zm.data(b,"emotions.attached",true)}}}},function(){zm.extend(zmCore,{renderEmotions:function(j,n){if(!zmEmotion.initialized){zmEmotion.init();zmEmotion.initialized=true}var b=zmEmotion.cached,m=n&&n.preventEntities||false,g=n&&n.preventLink||false,f=n&&n.maxNumber||false,l=-1,h=0,c=n&&n.stickerType||0;function a(d,e){return d.replace(new RegExp("(\\S*)("+e.code+")","gi"),function(r,p,o,u,q){var s;if(q.substring(u,u+r.length+1)==r+'"'||u<l){s=r}else{if((m&&/&amp|&lt|&gt/.test(p)&&o.indexOf(";")==0)||(g&&/http:\/\/.*/.test(p))){s=r}else{var t=a(p,e);if(f){if(h>=f){s=t+o}else{h++}}s=t+e.src}}l=u+s.length;return s})}var i=b["emotion.1"];for(var k in i){if(m||g){j=a(j,i[k])}else{j=j.replace(new RegExp(i[k].code,"gi"),function(d,p,e){var o;if(e.substring(p-5,p+d.length+1)=='alt="'+d+'"'||p<l){o=d}else{if(f&&++h>f){o=i[k].code}else{o=i[k].src}}l=p+o.length;return o})}}h=0;j=j.replace(/\[e\](\d+)\[\/e\]/gi,function(p,d,s,o){if(o.substring(s-5,s+p.length+1)=='alt="'+p+'"'){return p}var r="e"+d,q;for(var e in b){if(e.indexOf("emotion.")<0){continue}q=b[e][r];if(q){return f&&++h>f?q.code:q.src}}});h=0;j=j.replace(/\[t=(\d+)\]([^[]*)\[\/t\]/gi,function(u,t,s,r,q){if(++h>3){return u}if(q.substring(r-5,r+u.length+1)=='alt="'+u+'"'){return u}var d="s"+t,o;for(var e in b){if(e.indexOf("sticker.")<0&&e.indexOf("store.")<0){continue}o=b[e][d];if(o){var p;if(c==2){p='<a onmouseout="zmEmotion.hoverOut()" onmouseover="zmEmotion.hoverIn(this)" class="sticker_item_link" alt="'+u+'" >'+s+"</a><br/>"+o.src}else{if(c==1){p='<img class="zmpstk" alt="'+u+'" title="'+o.desc+'" src="'+o.url+'" />'}else{p='<a onmouseout="zmEmotion.hoverOut()" onmouseover="zmEmotion.hoverIn(this)" class="sticker_item_link" alt="'+u+'" >'+s+"</a>"}}if(n&&zm.isFunction(n.onRenderSticker)){n.onRenderSticker(o.desc,o.url,u)}return p}}return u});return j},hasEmotion:function(a){var b=zmEmotion.cached["emotion.1"];for(var c in b){if(b[c].sign==a){return true}}return false}});zmEmotion=(function(){var c={},f,e;function l(){zm("body").append('<div class="db_sticker boxshadow" id="zmemotion" style="display: none; z-index: 1000;">				<span id="zmemotion_toparr" class="stt_icosprt icoarrowemo top" style="display: none"></span>				<span id="zmemotion_botarr" class="stt_icosprt icoarrowemo bot" style="display: none"></span>				<a href="#" id="zmemotion_close" title="Đóng"><span class="stt_icosprt icodel"></span></a>				<div class="bd_tabsticker">					<a class="sel" href="#" rel="emotion"><span class="feed_sprt icotabarrow"></span>Biểu cảm</a>					<a href="#" rel="sticker"><span class="feed_sprt icotabarrow" style="display: none"></span>Hình động Zing Me</a>					<a href="#" rel="store"><span class="feed_sprt icotabarrow" style="display: none"></span>Kho hình động</a>					<div class="clr"></div>				</div>				<div class="db_conticker emotion">					<ul class="db_tabsubsticker"></ul>					<div class="list"></div>					<p class="db_exsticker">						<img width="24" height="24" src="'+zmConfig.IMAGE_URL+'/blank.gif" style="background:url('+zmConfig.EMOTION_URL+'/emo/default/1.jpg) no-repeat 50% 50%" alt="">						<span class="db_code">:D</span>Cười mỉm					</p>				</div>				<div class="db_conticker sticker" style="display: none">					<ul class="db_tabsubsticker"></ul>					<div class="list"></div>					<p class="db_exsticker"></p>				</div>				<div class="db_conticker store" style="display: none">					<ul class="db_tabsubsticker"></ul>					<div class="list"></div>					<p class="db_exsticker"></p>				</div>			</div>')}function i(){var v=emoticonV2.sticker,q=[],r=[];for(var t=0;t<v.length;t++){var u=v[t];u.from=="zme"?q.push(u):r.push(u)}emoticonV2.sticker=q;emoticonV2.store=r}function h(){var r,A,t=[],y=emoticonV2.emo;var z=zm.storage.get("emofav."+zmConfig.viewerId+".emotion",true);if(zm.objectLength(z)>0){y.unshift({id:0,name:"Yêu thích",items:z})}for(var v=0;v<y.length;v++){var w=y[v],x={},q={};t.push({id:w.id,name:w.name});for(var u=0;u<w.items.length;u++){A=w.items[u];A.desc=A.desc.charAt(0).toUpperCase()+A.desc.slice(1);var s=A.sign.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");r='<img class="zmpemo" alt="'+A.sign.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'" title="'+A.desc+'" src="'+zmConfig.EMOTION_URL+"/emo/"+A.url+'" />';x["e"+A.id]={id:A.id,desc:A.desc,code:s,sign:A.sign,src:r,ourl:A.url,url:zmConfig.EMOTION_URL+"/emo/"+A.url};if(w.id==1&&/[<>&]/g.test(s)){q["e"+(A.id+100)]={id:A.id+100,desc:A.desc,code:s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),sign:A.sign,src:r,ourl:A.url,url:zmConfig.EMOTION_URL+"/emo/"+A.url}}}v==0&&m(x,w.id);zm.extend(x,q);c["emotion."+w.id]=x}d(t,"emotion")}function j(){var q,A,w=emoticonV2.sticker,z=[];var u=zm.storage.get("emofav."+zmConfig.viewerId+".sticker",true),t=false;if(zm.objectLength(u)>0){w.unshift({id:0,name:"Yêu thích",items:u,enable:true})}for(var y=0;y<w.length;y++){var B=w[y],v=[];if(!B.enable){continue}z.push({id:B.id,name:B.name});for(var x=0;x<B.items.length;x++){A=B.items[x];A.desc=A.desc.charAt(0).toUpperCase()+A.desc.slice(1);q='<img class="zmpstk" width="55" height="55" alt="[t='+A.id+'][/t]" title="'+A.desc+'" src="'+zmConfig.EMOTION_URL+"/sticker/"+A.url+'" />';v["s"+A.id]={desc:A.desc,code:A.id,src:q,ourl:A.url,url:zmConfig.EMOTION_URL+"/sticker/"+A.url}}if(!t&&(B.selected||B.id==14)){p(v);t=true}c["sticker."+B.id]=v}d(z,"sticker")}function g(){var t,z,y=emoticonV2.store,B=[];var x=zm.storage.get("emofav."+zmConfig.viewerId+".store",true),u=false;if(zm.objectLength(x)>0){y.unshift({id:0,name:"Yêu thích",items:x,enable:true})}for(var w=0;w<y.length;w++){var A=y[w],q=[];if(!A.enable){continue}B.push({id:A.id,name:A.name});for(var v=0;v<A.items.length;v++){z=A.items[v];z.desc=z.desc.charAt(0).toUpperCase()+z.desc.slice(1);t='<img class="zmpstk" width="55" height="55" alt="[t='+z.id+'][/t]" title="'+z.desc+'" src="'+zmConfig.EMOTION_URL+"/sticker/"+z.url+'" />';q["s"+z.id]={desc:z.desc,code:z.id,src:t,ourl:z.url,url:zmConfig.EMOTION_URL+"/sticker/"+z.url}}if(!u){b(q);u=true}c["store."+A.id]=q}d(B,"store")}function d(q,w){if(!q){return}var x=zm("#zmemotion ."+w+" .db_tabsubsticker");for(var u=0;u<q.length;u++){var v=q[u],t=zm.createElement("LI"),r='<a class="'+((w=="sticker"&&(v.selected||v.id==14))||(w!="sticker"&&u==0)?"sel":"")+'" rel="'+v.id+'" href="#">'+v.name+(v.isNew||v.id==14?' <img src="'+zmConfig.IMAGE_URL+'/icon_new.gif" />':"")+"</a>";zm(t).html(r);u==q.length-1&&zm(t).addClass("end");x.append(t)}x.find("a").click(function(z){if(zm(this).hasClass("sel")){return false}x.find("a").removeClass("sel");zm(this).addClass("sel");var A=zm(this).attr("rel"),s=zmEmotion.cached;if(s[w+"."+A]){var y=s[w+"."+A];w=="sticker"?p(y):(w=="store"?b(y):m(y,A))}return false})}function m(t,C){var u,D,y=0,x="",B=C==3?65:24,v=C==3?31:24,A=zm("#zmemotion .emotion .list"),z=new zm.ScrollableUI({width:446,height:182});A.empty().append(z.getElement());for(u in t){D=t[u];x+='<li><img name="'+D.sign+'" width="'+B+'" height="'+v+'" alt="'+D.id+'" title="'+D.desc+'" src="'+zmConfig.IMAGE_URL+'/blank.gif" style="background:url('+D.url+') no-repeat 50% 50%"></li>';if(y==0){var q=zm("#zmemotion .emotion .db_tabsubsticker li a.current").attr("rel"),r=D.src;r+=q==1?' <span class="code_emo">'+D.code+"</span> ":"";r+='<span class="exp_emo">'+D.desc+'</span><div class="clr"></div>';zm("#zmemotion .emotion .db_exsticker").html(r)}y++}z.setContent('<ul class="db_emo">'+x+"</ul>");o("emotion")}function p(r){var t,B,A=55,u=55,x=0,v="",z=zm("#zmemotion .sticker .list"),y=new zm.ScrollableUI({width:446,height:182});z.html("").append(y.getElement());for(t in r){B=r[t];v+='<li><img name="'+B.code+'" width="'+A+'" height="'+u+'" alt="'+B.code+'" title="'+B.desc+'" src="'+zmConfig.IMAGE_URL+'/blank.gif" style="background:url('+B.url+') no-repeat 50% 50%"></li>';if(x==0){var q='<span class="explainfl"><span class="exp_emo">'+B.desc+'</span></span>							<div class="clr"></div>';zm("#zmemotion .sticker .db_exsticker").html(q)}x++}y.setContent('<ul class="db_emo">'+v+"</ul>");o("sticker")}function b(r){var t,B,A=55,u=55,x=0,v="",z=zm("#zmemotion .store .list"),y=new zm.ScrollableUI({width:446,height:182});z.html("").append(y.getElement());for(t in r){B=r[t];v+='<li><img name="'+B.code+'" width="'+A+'" height="'+u+'" alt="'+B.code+'" title="'+B.desc+'" src="'+zmConfig.IMAGE_URL+'/blank.gif" style="background:url('+B.url+') no-repeat 50% 50%"></li>';if(x==0){var q='<span class="explainfl"><span class="exp_emo">'+B.desc+'</span></span>							<div class="clr"></div>';zm("#zmemotion .store .db_exsticker").html(q)}x++}y.setContent('<ul class="db_emo">'+v+"</ul>");o("store")}function o(q){zm("#zmemotion ."+q+" .list li img").click(function(){setTimeout("zm('#zmemotion').hide(); zmEmotion.button && zm(zmEmotion.button).removeClass('sel');",100);zm.plugins.emotions.show=false;var y=zmEmotion.currentEditor;if(y!=null){var A=this,r=A.tagName=="IMG"?A.src:r;zm.plugins.emotions.showingEmots=false;try{var t=zm(y),G=zm.data(y,"emotions.options");if(t.css("display")!="none"||G.force){var F=G&&G.insert,w=zm(A),u=0,B=w.attr("title");if(q=="sticker"||q=="store"){var E=w.attr("name");B="[t="+E+"]"+B+"[/t]"}else{B=w.attr("name")}B+=" ";if(t.val()){var D=new RegExp("\\[t=(\\d+)\\]([^\\[]*)\\[\\/t\\]","g"),v=t.val(),x=v.match(D);u=x?x.length:0}if(u<3||(q!="sticker"&&q!="store")){if(zm.isFunction(F)){F.call(y,B,r)}else{var z=true,C=G&&G.beforeInsert,s=G&&G.afterInsert;if(zm.isFunction(C)){z=C.call(y,B,r)}z!==false&&t.insertAtCaret(B);zm.isFunction(s)&&s.call(y,B,r)}a(w,q)}else{zm.Boxy.alert("Bạn chỉ được thêm tối đa 3 hình động","Thông báo",5000)}}}catch(A){}zmEmotion.currentEditor=null}}).hover(function(){var v=zm("#zmemotion ."+q+" .db_exsticker"),s=zm(this);if(q=="sticker"||q=="store"){v.find(".exp_emo").html(s.attr("title"))}else{var r=s.attr("name"),u=s.attr("title"),w=zm("#zmemotion ."+q+" .db_tabsubsticker li a.current").attr("rel"),t=s.css("background-image").replace("url(","").replace(")","").replace(/[\'\"]/g,"");v.find(".code_emo").html(r);v.find(".exp_emo").html(u);v.find("img").attr({src:t,title:u});w!=1&&v.find(".code_emo").hide()}},function(){})}function a(v,r){var A,y=1,w=false,q=v.attr("alt"),B="emofav."+zmConfig.viewerId+"."+r,z=zm("#zmemotion .db_conticker."+r+" .db_tabsubsticker li a.sel").attr("rel"),t=r=="sticker"||r=="store"?"s":"e",D=zmEmotion.cached[r+"."+z][t+q],u=r=="sticker"||r=="store"?21:90;if(z==3&&r!="sticker"&&r!="store"){return}r=r=="sticker"?r:(r=="store"?r:"emo");A=zm.storage.get(B,true);A=!A?new Array():A;for(var x=0;x<A.length;x++){if(A[x].id==q){A[x].count++;w=true;break}}if(!w){var C={id:q,desc:D.desc,url:D.ourl,count:y};C.sign=r!="sticker"&&r!="store"?v.attr("name"):C.sign;A.unshift(C)}A.sort(n);A.length>u&&A.splice(u,A.length-u);zm.storage.put(B,A,0,true)}function k(){zm("#zmemotion").clickOutside(function(){zm.plugins.emotions.show&&zmEmotion.close()});zm("#zmemotion_close").click(function(){zmEmotion.close();return false});zm("#zmemotion .bd_tabsticker a").click(function(){var r=zm(this);if(r.hasClass("sel")){return false}var q=r.attr("rel");zm("#zmemotion .db_conticker").hide();zm("#zmemotion ."+q).show();zm("#zmemotion .bd_tabsticker a").removeClass("sel").find(".icotabarrow").hide();r.addClass("sel").find(".icotabarrow").show();return false})}function n(r,q){return r.count>=q.count?-1:1}return{init:function(){if(this.initialized||!window.emoticonV2){return}l();i();h();j();g();zmEmotion.cached=c;k();this.bindStickerEvent();this.initialized=true},setCate:function(r,q){zm("#zmemotion .bd_tabsticker a").removeClass("sel").find("[rel="+r+"]").addClass("sel");zm("#zmemotion .db_conticker").hide();zm("#zmemotion ."+r).show().find(".db_tabsubsticker li").each(function(){var s=zm(this).find("a").attr("rel");if(s==q){zm(this).find("a").click();return}})},close:function(){zm("#zmemotion").hide();zmEmotion.button&&zm(zmEmotion.button).removeClass("sel");zm.plugins.emotions.show=false;zmEmotion.currentEditor=null;zmEmotion.button&&zm(zmEmotion.button).removeClass("sel")},setPosition:function(v,E,u){var x=zm(v),r=zm(u||"#zmemotion");if(E&&zm.isFunction(E.setPosition)){E.setPosition.call(r,x)}else{if(!E){E={}}var A=zm.getViewport(),y=x.offset(true),s=r.outerWidth(),C=r.outerHeight(),z=y.top,w=y.left,t=x.data("emotions.position")||"absolute",q;if(z-A.offsetY>C+10){z-=C+10;q="bot"}else{z+=x.height()+10;q="top"}if(A.width-w+A.offsetX>s+50){w-=35}else{w-=s-x.width()-35}if(t=="fixed"){w-=A.offsetX;z-=A.offsetY}if(zm.isFunction(E.onSetPosition)){var D=E.onSetPosition(w,z);if(D){if(D.left>0){w=D.left}if(D.top>0){z=D.top}}}else{w+=zm.intval(E.offsetLeft);z+=zm.intval(E.offsetTop)}w=Math.max(w,0);z=Math.max(z,0);r.css({left:w+"px",top:z+"px",position:t});zm("#zmemotion_"+(q=="top"?"bot":"top")+"arr").hide();var B=zm("#zmemotion_"+q+"arr").show();B.css("left",Math.max(y.left-w-zm.intval(r.css("border-left-width"))+(x.width()-B.width())/2,10)+"px")}},hoverIn:function(s){e=true;if(!f){f=new zm.CalloutPopup({valign:true,scrollable:false,center:true,zIndex:53});zm(f.getElement()).css("min-width",0)}var q=zm(s).attr("alt").replace("full_","big_"),r=new Image();r.src="http://emo.me.zdn.vn/sticker/"+q;r.onload=function(){if(!e){return}f.setContent(r);f.show(s)}},hoverOut:function(){e=false;f.hide()},bindStickerEvent:function(q){q=q?"#"+q+" ":"";zm(q+".sticker_item_link").hover(function(){zmEmotion.hoverIn(this)},function(){zmEmotion.hoverOut()});zm(window).scroll(function(){e&&zmEmotion.hoverOut()})},addStickerViewer:function(q){zm.each(q,function(){zm(this).click(function(){var r=zm(this).attr("src");r=r.replace("big_","full_");zm.showSimpleViewer('<div style="background-color:#FFF;"><img src="'+r+'" /></div>');return false})})}}})();zm.emoSetCat=zmEmotion.setCate;zm.plugins.emotions.close=zmEmotion.close;zm.plugins.emotions.setPosition=zmEmotion.setPosition;zm.plugins.emotions.hi=zmEmotion.hoverIn;zm.plugins.emotions.ho=zmEmotion.hoverOut;zm.plugins.emotions.hoverSticker=zmEmotion.bindStickerEvent;zm.plugins.emotions.init=zmEmotion.init});zm.install("boxy",null,function(){zm.plugins.boxy.defOptions={noTitle:false,title:"",content:"",closeButton:true,footer:true,modal:true,okButton:"Đồng ý",cancelButton:"",center:true,animated:true,scroll:true,revert:false,header:false};zm.plugins.boxy.activeInstances=[];zm.plugins.boxy.count=0;zm.Boxy=function(w){var z,J,G,n,f,u,o,D,T,i,I,U=zm.extend({},zm.plugins.boxy.defOptions,w),j=this,Z=false,d=null,E=null,C,g=false,P,N,c,b,L,K,Q=zm.plugins.boxy.count++;p();B(U.zIndex);U.isTop&&k();function p(){var ac=zm.createElement("DIV",{"class":"zmpopup"+(U.boxyClass?(" "+U.boxyClass):"")}),ab=zm.createElement("DIV",{"class":"zmpopup_overlay"},{display:"none"});G=zm.createElement("DIV",{"class":"zmputitle"+(U.titleClass?(" "+U.titleClass):"")});n=zm.createElement("DIV",{"class":"zmpucont"+(U.contentClass?(" "+U.contentClass):"")});f=zm.createElement("DIV");u=zm.createElement("DIV");x(U.title);O(U.header);h(U.content);ac.appendChild(G);ac.appendChild(n);n.appendChild(f);n.appendChild(u);if(U.footer){D=zm.createElement("DIV",{"class":"zmpubtn"});o=zm.createElement("DIV",{"class":"zmpubot"});t();o.appendChild(D);ac.appendChild(o);U.okButton&&q();U.cancelButton&&y()}ab.appendChild(ac);document.body.appendChild(ab);U.closeButton&&X();!(zm.browser.msie&&zm.browser.version<7)&&S();z=zm(ac);J=zm(ab);U.hideOnClickOutside&&J.click(e)}function e(){if(zm(this).hasClass("zmpopup_overlay")){j.hide()}}function q(){if(!D){return}T=zm.createElement("A",{"class":"submitbtn",tabIndex:"0",href:"#"});s(0);zm(T).click(function(){j.close(true);return false}).html(U.okButton);D.appendChild(T)}function y(){if(!D){return}i=zm.createElement("A",{"class":"cancelbtn",tabIndex:"0",href:"#"});s(1);zm(i).click(function(){j.close(false);return false}).html(U.cancelButton);U.revert?D.insertBefore(i,T):D.appendChild(i)}function X(){I=zm.createElement("A",{"class":"zmpuclose",href:"#",title:"Đóng"});s(2);G.parentNode.insertBefore(I,G);zm(I).click(function(){j.close("close");return false}).html("<span></span>")}function s(ad){var ab="",ac;if(ad==0){if(U.okClass){ab=U.okClass}else{ab="submitbtn"}ac=T}else{if(ad==1){if(U.cancelClass){ab=U.cancelClass}else{ab="cancelbtn"}ac=i}else{if(ad==2){if(U.closeClass){ab=U.closeClass}else{ab="zmpuclose"}ac=I}}}ac&&zm(ac).attr("class",ab)}function S(){zm(G).mousedown(aa);zm.browser.msie&&zm(G).bind("selectstart",function(){return false});zm(document).mousemove(A).mouseup(H);this.moved=false}function k(ab){if(ab!=undefined){U.isTop=ab}if(U.isTop){if(!j.stopOutside){j.stopOutside=function(ac){H();U.isTop&&!zm.ScrollableUI.draggingObj&&ac.stopPropagation()};z.mouseup(j.stopOutside)}}else{j.stopOutside&&z.unbind("mouseup",j.stopOutside)}}function x(ab){if(ab){U.title=ab}if(U.title){zm(G).html("<strong>"+U.title+"</strong>").show()}else{zm(G).hide()}}function O(ab){if(ab){U.header=ab}if(U.header===false){U.header="<span></span>"}if(!f&&!U.header){return}if(U.header){zm(f).html(U.header).show()}else{if(f){zm(f).hide()}}}function h(ab){if(ab){U.content=ab}if(u&&U.content){var ac=U.content;if(zm.isString(ac)){zm(u).html(ac)}else{zm(u).empty().append(ac)}}}function W(){if(U.footer){if(!o){o=zm.createElement("DIV",{"class":"zmpubot"});z.append(o);D=zm.createElement("DIV",{"class":"zmpubtn"});o.appendChild(D);t()}else{zm(o).show()}}else{o&&zm(o).hide()}}function t(){var ab=zm.createElement("DIV",{"class":"return_action"});zm(ab).html('<div class="zmpumsg" style="display: none"></div><p class="zmpuloading zmloading32" style="display: none"><em></em><span>'+(U.loadingText||"")+"</span></p>");zm(D).prepend(ab)}function V(){if(U.okButton){T?zm(T).html(U.okButton).show():q()}else{if(U.okButton===false&&T){zm(T).hide()}}}function R(){if(U.cancelButton){i?zm(i).html(U.cancelButton).show():y()}else{if(U.cancelButton===false&&i){zm(i).hide()}}}function m(){if(U.closeButton){I?zm(I).show():X()}else{I&&zm(I).hide()}}function B(ab){if(ab&&typeof ab=="number"){U.zIndex=ab}U.zIndex&&J.css("z-index",U.zIndex)}function l(){J[U.modal?"addClass":"removeClass"]("zmpopup_overlay")}function v(){if(zm.isString(U.boxyClass)){z.attr("class","zmpopup "+U.boxyClass)}if(G&&zm.isString(U.titleClass)){zm(G).attr("class","zmputitle "+U.titleClass)}if(zm.isString(U.contentClass)){zm(n).attr("class","zmpucont "+U.contentClass)}if(zm.isString(U.okClass)){s(0)}if(zm.isString(U.cancelClass)){s(1)}if(zm.isString(U.closeClass)){s(2)}}function M(){zm.isFunction(U.beforeShow)&&U.beforeShow.call(j);J.show();Z=true;j.locate();if(zm(document.body).css("overflow")!="hidden"){zm(document.body).css("overflow","hidden");C=true}if(U.okButton&&U.autoFocus!=false){try{T&&zm(T).focus()}catch(ab){}}if(zm.inArray(j,zm.plugins.boxy.activeInstances)==-1){zm.plugins.boxy.activeInstances.push(j)}zm.Key.queueDocEscape("boxy"+Q)}function aa(ac){if(ac.button!=0){return}g=true;var ad=zm(this).offset(true);P=ad.left;N=ad.top;var ab=zm.getMousePosition(ac);c=ab.left;b=ab.top;zm(document.body).css("cursor","move");return false}function A(ad){if(g){j.moved=true;var ab=zm.getMousePosition(ad),ac=zm.getViewport();if(zm.browser.msie){L=ab.left-c+P-8-ac.offsetX;K=ab.top-b+N-8-ac.offsetY}else{L=ab.left-c+P-ac.offsetX-8;K=ab.top-b+N-ac.offsetY-8}j.moveTo(L,K,false)}}function H(){g=false;j.moved=false;zm(document.body).css("cursor","")}function Y(ab){if(ab==zm.Boxy.BUTTON.OK){return T}else{if(ab==zm.Boxy.BUTTON.CANCEL){return i}}}function r(){var ab=true;zm(n).find('textarea[data-required="1"],input[data-required="1"]').each(function(){if(!this.value||this.value.length<(this.minLength||1)||(this.maxLength>0&&this.value.length>this.maxLength)){ab=false;return false}});if(ab){j.enableButton(zm.Boxy.BUTTON.OK)}else{j.disableButton(zm.Boxy.BUTTON.OK)}}function F(ab){C&&zm(document.body).css("overflow","");C=false;zm.isFunction(ab)&&ab()}this.centerX=function(){var ac,ab=z.outerWidth(),ad=zm.getViewport();ac=Math.round((ad.width-ab)/2);if(zm.isNumber(U.offsetLeft)){ac+=U.offsetLeft}z.css("left",(ac<0?"0":ac)+"px")};this.centerY=function(){var ab,ac=z.outerHeight();if(d==null){d=zm.getViewport().height}ab=Math.round((d-ac)/2);if(E!=null){ab+=E-U.iframeTopOffset}if(zm.isNumber(U.offsetTop)){ab+=U.offsetTop}z.css("top",(ab<0?"0":ab)+"px")};this.center=function(){this.centerX();this.centerY()};this.locate=function(){if(this.moved){return}if(zm.isFunction(U.setPosition)){U.setPosition.call(this)}else{U.center&&this.center()}};this.moveTo=function(ab,ad,ac){this.moveToX(ab,ac);this.moveToY(ad,ac)};this.moveToX=function(ab,ac){if(ab!=undefined){if(ab=="center"){this.centerX()}else{z.css("left",ab+"px")}}};this.moveToY=function(ac,ab){if(ac!=undefined){if(ac=="center"){this.centerY()}else{if(E!=null&&ab!=false){ac+=E-U.iframeTopOffset}z.css("top",ac+"px")}}};this.show=function(){if(Z){return}if(typeof zmXCall!="undefined"&&typeof U.iframeTopOffset=="number"){zmXCall.getTop(function(ab){d=ab.height;E=ab.top;M()})}else{d=E=null;M()}};this.hide=function(ac){if(!Z){return}zm.isFunction(U.beforeHide)&&U.beforeHide();if(ac!==false&&U.animated){if(zm.browser.msie){J.hide();F(U.afterHide)}else{J.fadeOut(400,function(){F(U.afterHide)})}}else{J.hide();F(U.afterHide)}Z=false;zm.Key.dequeueDocEscape("boxy"+Q);if(this==zm.plugins.boxy.alertInstance&&zm.plugins.boxy.alertTimeout){clearTimeout(zm.plugins.boxy.alertTimeout)}var ab=zm.inArray(this,zm.plugins.boxy.activeInstances);ab>-1&&zm.plugins.boxy.activeInstances.splice(ab,1)};this.isShowing=function(){return Z};this.getElement=function(){return z[0]};this.setTitle=function(ab){x(ab);return this};this.setHeader=function(ab){O(ab);return this};this.setContent=function(ab){h(ab);this.locate();return this};this.close=function(ac){var ab=true;if(ac==="close"){zm.isFunction(U.onClose)&&U.onClose.call(this)}else{if(ac){if(zm(T).hasClass("disable")){return}if(zm.isFunction(U.onOk)){ab=U.onOk.call(this)}}else{if(zm(i).hasClass("disable")){return}if(zm.isFunction(U.onCancel)){ab=U.onCancel.call(this)}}}ab!==false&&this.hide()};this.enableButton=function(ac){var ab=Y(ac);ab&&zm(ab).removeClass("disable")};this.disableButton=function(ac){var ab=Y(ac);ab&&zm(ab).addClass("disable")};this.showLoading=function(ab){zm(o).find(".zmpumsg").hide();if(ab){U.loadingText=ab}zm(o).find(".zmpuloading").show().find("span").text(U.loadingText||"")};this.hideLoading=function(){zm(o).find(".zmpuloading").hide()};this.showMessage=function(ab){if(!ab){return}zm(o).find(".zmpumsg").html(ab).show();this.hideLoading()};this.hideMessage=function(){zm(o).find(".zmpumsg").hide()};this.showSuccessMessage=function(ab){this.showMessage('<div class="msg_success msg_symbol msginfo_nobg"><span class="msgicon"></span>'+ab+"</div>")};this.showErrorMessage=function(ab){this.showMessage('<div class="msg_error msg_symbol msginfo_nobg"><span class="msgicon"></span>'+ab+"</div>")};this.clearIframeSize=function(){d=E=null};this.changeSettings=function(ac,ab){if(!ac){return}if(!U){U=zm.extend({},zm.plugins.boxy.defOptions)}if(!ab){U=zm.extend(U,ac)}else{U=zm.extend({},zm.plugins.boxy.defOptions,ac)}zm.isString(ac.title)&&x();zm.isString(ac.content)&&h();if(!zm.isNumber(U.iframeTopOffset)){d=E=null}l();O();W();V();R();m();B();k();v();if(U.checkInput){this.checkInput();this.disableButton(zm.Boxy.BUTTON.OK)}J.unbind("click",e);if(U.hideOnClickOutside){J.click(e)}};this.getSettings=function(){return U};this.checkInput=function(){zm(n).find('textarea[data-required="1"],input[data-required="1"]').each(function(){zm(this).keyup(r).bind("zminsertatcaret",r)})};this.destroy=function(){J.remove()};zm.Key.bindDocEscape("boxy"+Q,this.hide);if(U.checkInput){this.checkInput();this.disableButton(zm.Boxy.BUTTON.OK)}};function a(){var d=zm.plugins.boxy.activeInstances;for(var c=0,b;b=d[c];c++){b.clearIframeSize();b.locate()}}zm.ready(function(){zm(window).resize(a)});zm.Boxy.BUTTON={OK:1,CANCEL:2};zm.extend(zm.Boxy,{alert:function(d,g,f,b){var e;if(zm.plugins.boxy.alertInstance){e=zm.plugins.boxy.alertInstance=zm.Boxy.Alert}else{e=new zm.Boxy({zIndex:52});zm.plugins.boxy.alertInstance=zm.Boxy.Alert=e}var c={boxyClass:"pu_small",isTop:false};zm.extend(c,b,{content:d,title:g});e.changeSettings(c,true);e.show();if(f){zm.plugins.boxy.alertTimeout=setTimeout(function(){e.hide()},f)}},stopAlert:function(){zm.plugins.boxy.alertInstance&&zm.plugins.boxy.alertInstance.hide()},confirm:function(d,f,b){var e=zm.plugins.boxy.confirmInstance=zm.Boxy.Confirm;if(!e){e=new zm.Boxy({zIndex:51});zm.plugins.boxy.confirmInstance=zm.Boxy.Confirm=e}var c={boxyClass:"pu_small",isTop:false};zm.extend(c,b,{content:d,onOk:f});e.changeSettings(c,true);e.show()},stopConfirm:function(b){zm.plugins.boxy.confirmInstance&&zm.plugins.boxy.confirmInstance.hide(b)}})});zm.install("autoresize",{autoResize:function(b){this.css("overflow-y","hidden");var a=function(c){if(zm.data(this,"autoresize.stop")){return}zm.plugins.autoresize.resizing=this;if(c.type=="paste"){var d;if(window.clipboardData&&window.clipboardData.getData){d=window.clipboardData.getData("Text")}else{if(c.clipboardData&&c.clipboardData.getData){d=c.clipboardData.getData("text/plain")}}if(d!=undefined){zm.plugins.autoresize.onchange(c,b,d)}else{if(zm.plugins.autoresize.timer){clearTimeout(zm.plugins.autoresize.timer)}zm.plugins.autoresize.timer=setTimeout(function(){zm.plugins.autoresize.onchange(c,b)},10)}}else{zm.plugins.autoresize.onchange(c,b)}};this.change(a).keydown(a).keyup(a).focus(a).bind("paste",a);return this},startAutoresize:function(){this.removeData("autoresize.stop",1)},stopAutoresize:function(){this.data("autoresize.stop",1)}},function(){zm.plugins.autoresize.counter=0;zm.plugins.autoresize.clone=function(d){var g=zm(d),f=zm(zm.createElement("TEXTAREA",{id:"zmjs-text-resizer-"+ ++zm.plugins.autoresize.counter})),c=zm.plugins.autoresize.styles;for(var a=0,b;b=c[a];a++){f.css(b,g.css(b))}f.css({border:"none",height:"1px",padding:"0",overflow:"hidden"});if(zm("#zmjs-text-resize").size()<1){zm(document.body).append('<div id="zmjs-text-resize" style="position: absolute;top: -999px; left: -999px;visibility: hidden;"></div>')}zm("#zmjs-text-resize").append(f);g.data("autoresize.height",g.innerHeight()).data("autoresize.clone",zm.plugins.autoresize.counter)};zm.plugins.autoresize.onchange=function(j,l,i){var d=zm.plugins.autoresize.resizing,k=zm(d);!zm.data(d,"autoresize.clone")&&zm.plugins.autoresize.clone(d);if(k.width()<=0){return}var f=zm("#zmjs-text-resizer-"+k.data("autoresize.clone"));f.text(k.val()+(i||"")+"...");var g=zm.intval(k.css("padding-top"))+zm.intval(k.css("padding-bottom")),a=Math.max(f[0].scrollHeight+g,k.data("autoresize.height")),c;if(l&&zm.isFunction(l.onresize)){var b=zm.intval(k.innerHeight());if(a!=b){c=l.onresize.call(d,a,b)}}c!==false&&k.css("height",a+"px");if(l&&zm.isFunction(l.afterResize)){l.afterResize.call(d,a)}};zm.plugins.autoresize.styles=["font-family","font-size","font-weight","font-style","line-height","word-wrap","width"]});zm.install("popup",{calloutPopup:function(f,j){if(this.size()==0){return}var h=true,g=(j&&j.followElement&&zm(j.followElement))||this;g.parents().each(function(){if(zm(this).css("display")=="none"){h=false;return false}});if(!h){return}j=zm.extend({},zm.plugins.popup.defOptions,j);if(!zm.plugins.popup.instance){zm.plugins.popup.instance=new zm.CalloutPopup()}else{zm.plugins.popup.instance.clearSettings()}zm.plugins.popup.instance.setHeader(j.header);zm.plugins.popup.instance.setContent(f);zm.plugins.popup.instance.setFooter(j.footer);if(this.domData("processed")!=1){this.domData("processed",1);this.clickOutside(function(){zm.plugins.popup.instance.element==this&&zm(this).hideCalloutPopup()},0,true,j.group||"zmcog.popup");this.clickOutsideWith(zm.plugins.popup.instance.getElement())}var d,a,b=this;if(j.checkImage){d=zm(zm.plugins.popup.instance.getTempElement()).find("img");if(j.ignoreImages){a=zm(j.ignoreImages)}var c=0,i=function(){if(zm(this).parents("body").size()==0){return}c++;if(c==d.size()){zm.plugins.popup.instance.show(b,g,j)}}}if(d&&d.size()>0){d.each(function(){if(a&&zm.inArray(this,a)>-1){return}if(this.complete){i.call(this)}else{this.onload=this.onerror=i}})}else{if(j.delay){if(zm.plugins.popup.timeout){clearTimeout(zm.plugins.popup.timeout)}zm.plugins.popup.timeout=setTimeout(function(){zm.plugins.popup.instance.show(b,g,j)},j.delay)}else{zm.plugins.popup.instance.show(this,g,j)}}},hideCalloutPopup:function(){zm.plugins.popup.instance.hide();zm.plugins.popup.instance.empty()},toggleCalloutPopup:function(c,b){var a=zm.plugins.popup.instance;if(a&&a.isShowing()){this.hideCalloutPopup()}else{this.calloutPopup(c,b)}},belongToCalloutPopup:function(){this.clickOutsideWith(zm.plugins.popup.instance.getElement())}},function(){zm.plugins.popup.defOptions={position:"absolute",close:true,popupClass:"",offsetTop:0,offsetLeft:0,checkImage:true,scrollable:true};zm.CalloutPopup=function(k){var j=this,c=zm.extend({},zm.plugins.popup.defOptions,k),g,e,d=zm.createElement("DIV",{"class":"ctndisbox",tabindex:"-1"},{top:"-9999px",left:"-9999px",outline:"none",zIndex:c.zIndex}),i=zm.createElement("DIV",{"class":"ctndisbox",tabindex:"-1"},{top:"-9999px",left:"-9999px",outline:"none","min-width":"0"}),h='<div class="disbox_inner">					<span class="toparrow icodisbox lefttop"></span>					<div class="disbox">						<div class="contdisbox cpscrollcont">							<div class="cpheader"></div>							<div class="cpcontent"></div>							<div class="cpfooter"></div>						</div>						<div class="contdisbox cpnoscrollcont" style="display: none;"></div>					</div>					<span class="botarrow icodisbox"></span>				</div>';zm(d).append(h);zm(i).append(h);document.body.appendChild(d);document.body.appendChild(i);g=new zm.ScrollableUI().appendTo(zm(d).find(".cpcontent"));zm(d).find(".cpclose").click(function(){j.hide();return false});b(c.header);a(c.content);f(c.footer);function b(l){var m=zm(i).find(".cpheader");if(l!=undefined||l!=null){m.empty().append(l).show()}else{m.hide()}}function a(l){if(l!=undefined||l!=null){zm(i).find(".cpcontent").empty().append(l)}}function f(l){var m=zm(i).find(".cpfooter");if(l!=undefined||l!=null){m.empty().append(l).show()}else{m.hide()}}this.show=function(P,m,p){if(arguments.length<=2){p=m;m=P}if(!(m instanceof zmCore)){m=zm(m)}zm.extend(c,p);zm.isFunction(c.beforeShow)&&c.beforeShow.call(P);var w=zm(d),A=zm(i),I="ctndisbox "+c.popupClass,J=c.position||"absolute",r=m.offset(J=="absolute"),s=m.outerHeight(),N=m.outerWidth(),K=zm.getViewport(),O=J=="absolute"?K.offsetY:0,F="icodisbox ",o="top",M="bot",D,q,C;A.attr("class",I);A.css("width",(c.width?c.width+"px":""));w.css("width",(c.width?c.width+"px":""));var n=A.outerHeight(true),Q=A.outerWidth(),x=c.minTop||20,v=c.minBottom||20,y=A.find(".cpcontent").outerHeight();if(c.maxContentHeight&&c.maxContentHeight<y){n-=y-c.maxContentHeight;y=c.maxContentHeight}var H=c.align;if(c.valign){if(r.top-O>(K.height-s)/2){D=r.top-n-8;o="bot";M="top";F+="bot"}else{D=r.top+s+8;o="top";M="bot";F+="top"}var L=A.find(".toparrow.lefttop").outerWidth(),G;if(c.center){q=r.left-(Q-N)/2;G=(Q-L)/2-2}else{if(r.left-K.offsetX+Q+10<K.width){q=r.left-L;G=25}else{q=r.left+N-Q+L;G=Q-25-20}}F+="left";C={"margin-top":"","margin-left":(c.arrowPos||G)+"px"}}else{if(H!="right"&&(r.left-K.offsetX>Q||r.left+N+Q>K.offsetX+K.width)){q=r.left-Q;F+="lefttop"}else{q=r.left+N;F+="righttop"}if(r.top<x+O){D=x+O}else{D=r.top}var u=K.height-n-x-v,E=Math.floor(s/2);if(u<0){D=x+O;y+=u}else{if(E<12){D+=E-12}var z;if((z=D+n+v-O-K.height)>0){D-=z}}var S=A.find(".toparrow.lefttop").height(),B=r.top-D+E-S/2;if(B<4){B=r.top+s-D-14}else{if(B+10>n/2){B=n/2-S/2}}if(E<12||B>n-5){B=""}else{B+="px"}C={"margin-left":"","margin-top":B}}w.find("."+o+"arrow").attr("class",F+" "+o+"arrow").css(C).show();w.find("."+M+"arrow").hide();D+=c.offsetTop;q+=c.offsetLeft;w.attr("class",I);var l=A.find(".cpheader").children();if(l.size()>0){w.find(".cpheader").empty().append(l).show()}else{w.find(".cpheader").empty().hide()}var R=A.find(".cpfooter").children();if(R.size()>0){w.find(".cpfooter").empty().append(R).show()}else{w.find(".cpfooter").empty().hide()}if(c.scrollable){w.find(".cpscrollcont").show();w.find(".cpnoscrollcont").hide();g.setWidth(A.find(".cpcontent").width());g.setContent(A.find(".cpcontent").children()).setHeight(y+1).updateScrollbar(false)}else{w.find(".cpscrollcont").hide();w.find(".cpnoscrollcont").empty().append(A.find(".cpcontent").children()).show()}w.find(".cpclose")[c.close?"show":"hide"]();w.css({top:D+"px",left:q+"px",position:c.position});j.element=P[0];zm.isFunction(c.afterShow)&&c.afterShow.call(this);e=true};this.hide=function(){zm.isFunction(c.beforeHide)&&c.beforeHide.call(j.elem);zm(d).css({top:"-9999px",left:"-9999px"});j.element=null;zm.isFunction(c.afterHide)&&c.afterHide();e=false};this.isShowing=function(){return e};this.getElement=function(){return d};this.getTempElement=function(){return i};this.empty=function(){g.empty();zm(d).find(".cpnoscrollcont").empty();zm(d).find(".cpheader").empty();zm(d).find(".cpfooter").empty()};this.clearSettings=function(){c=zm.extend({},zm.plugins.popup.defOptions)};this.setContent=a;this.setHeader=b;this.setFooter=f}});zm.install("scrollableui",{},function(){zm.ScrollableUI=function(e){var r=zm.extend({},zm.ScrollableUI.defaultSettings,e),B=true,o,b=false,F=false,t,u,q=[],w,A,j,E,h=zm.extend({"class":"zmscrollableui"+(r.uiClass?" "+r.uiClass:"")},r.uiAttrs),p=zm.extend({},r.uiStyles),v=zm.createElement("DIV",h,p),i=zm.createElement("DIV",{"class":"zmscrollableui_wrapper"+(r.wrapperClass?" "+r.wrapperClass:""),tabindex:"0"}),n=zm.createElement("DIV",{"class":"zmscrollableui_body"+(r.bodyClass?" "+r.bodyClass:"")}),y=zm.createElement("DIV",{"class":"zmscrollableui_content"+(r.contentClass?" "+r.contentClass:"")}),a=zm.createElement("DIV",{"class":"zmscrollableui_bar unselectable"+(r.scrollbarClass?" "+r.scrollbarClass:""),unselectable:"on"},{visibility:"hidden"}),f=zm.createElement("DIV",{"class":"zmscrollableui_gripper"+(r.gripperClass?" "+r.gripperClass:"")});v.appendChild(i);v.appendChild(a);i.appendChild(n);a.appendChild(f);n.appendChild(y);r.content&&zm(y).append(r.content);var l=zm(v);if(r.width){l.css("width",r.width+"px");zm(n).css("width",r.width+"px")}r.height&&l.css({height:r.height+"px"});function D(z){zm(n).hover(function(){zm.ScrollableUI.scrollingElement=i;c();x(true);!z.settings.alwaysShow&&g()},function(){c();if(!z.settings.alwaysShow&&!zm(z.getScrollbar()).hasClass("large")){var G=zm.ScrollableUI.draggingElement;if(!G||G.parentNode.parentNode!=this){o=setTimeout(g,500)}}if(zm.ScrollableUI.scrollingElement==i){zm.ScrollableUI.scrollingElement=null}});zm(v).mousemove(function(G){var H=zm(v);zm.ScrollableUI.movingUI=z;if(zm.getMousePosition(G).left-H.left()>=H.width()-30){c();F=true;x(true)}else{F=false;!z.settings.alwaysShow&&g()}});zm(i).scroll(function(J){c();var I=this.scrollTop,H=0;if(I==0){H=-1}else{if(I+this.offsetHeight==this.scrollHeight){H=1}}x(true);!z.settings.alwaysShow&&!F&&g();var G=z.settings.onscroll;zm.isFunction(G)&&G.call(this,z,J,H)});zm(a).hover(function(){c();j&&clearTimeout(j);z.switchScrollbar(true)},function(){if(z.mousedown){return}if(z.settings.alwaysShow){j&&clearTimeout(j);j=setTimeout(function(){z.switchScrollbar(false)},1000)}else{g()}}).click(function(H){if(zm(this).hasClass("large")){var I=zm.getMousePosition(H).top;k(z,I);var G=z.settings.onclickscrollbar;zm.isFunction(G)&&G.call(this,z,I)}}).bind("animationstart webkitAnimationStart oanimationstart MSAnimationStart",function(){w=true}).bind("animationend webkitAnimationEnd oanimationend MSAnimationEnd",function(){w=false;var G=zm(this);if(A){G.removeClass("large small").addClass("hasbg "+A);A=null}else{if(!G.hasClass("large")){G.removeClass("hasbg")}}});zm(f).mousedown(function(G){zm.ScrollableUI.scrollingElement=i;c();z.mousedown=true;z.offsetY=zm.getMousePosition(G).top-zm(this).top();zm.ScrollableUI.draggingObj=z;return false});if(r.maxHeight>0){d(z);z.maxHeight=r.maxHeight;var s=i.scrollHeight;if(!E&&s==0){s=z.maxHeight}else{s=Math.min(s,z.maxHeight)}zm(v).css("height",s+"px")}}function x(s){var K=i.offsetHeight,G=i.scrollHeight;if(K==G){m();return}var J=zm(a).show(),z=a.offsetHeight,H=z*K/G,I=zm(f);if(H>4){H-=4}I.css("height",H+"px");setTimeout(function(){H=I.outerHeight();var N=i.scrollTop,M,L=G-K;if(N>=L){M=z-H-6}else{M=(z-H-6)/L*N}I.css("top",M+"px");b=true;s&&!t&&J.css("visibility","").opacity(1)},50)}function g(){o&&clearTimeout(o);o=setTimeout(function(){m()},1000)}function m(s){if(!b){return}var z=zm(a);if(s===false){b=false;z.hide().removeClass("large hasbg")}else{z.fadeOut(function(){this.css("visibility","hidden").removeClass("large hasbg");var G=this;b=false;setTimeout(function(){G.show()},100)})}}function c(){o&&clearTimeout(o);o=null}function k(K,M){if(u){q.push(M);return}var z=i.offsetHeight,L=zm(a).top(),G=zm(f).top();if(L<M&&M<G){z=-z}else{if(G+f.scrollHeight>=M||M>=L+a.scrollHeight){return}}var N=K.scrollTop(),J=200,H=10,I=0,s=setInterval(function(){I+=H;K.scrollTop(N+C(z,J,I));if(I>=J){u=false;q.splice(0,1);q.length>0&&k(K,q[0]);clearInterval(s)}},H)}function C(G,I,H){var z=(H/I)*(Math.PI/2);return G*Math.abs(Math.sin(z))}function d(z){if(E){return}function s(G){var H;G.forEach(function(I){if(I.type=="childList"){H=true}});H&&z.updateHeight()}if(window.WebKitMutationObserver){E=new WebKitMutationObserver(s)}else{if(window.MutationObserver){E=new MutationObserver(s)}}E&&E.observe(y,{childList:true,subtree:true})}D(this);this.settings=r;this.height=zm.intval(r.height);this.width=zm.intval(r.width);this.init=function(){return this};this.appendTo=function(s){if(s.append){s.append(v)}else{s.appendChild(v)}this.init();return this};this.setContent=function(s){if(zm.isString(s)){zm(y).html(s)}else{zm(y).empty().append(s)}return this};this.empty=function(){zm(y).empty()};this.setWidth=function(z){var s=z;if(zm.isNumber(z)){s+="px"}this.width=zm.intval(z);zm(v).css("width",s);zm(n).css("width",s);return this};this.getWidth=function(){return this.width};this.setHeight=function(z){this.enableScrollTop();var s=z;if(!isNaN(z)&&zm.isNumber(z)){s+="px"}this.height=zm.intval(z);zm(v).css("height",s);return this};this.getHeight=function(){return zm(v).height()};this.setMaxHeight=function(s){this.enableScrollTop();if(!isNaN(s)&&zm.isNumber(s)){this.maxHeight=s;d(this);this.updateHeight()}};this.updateHeight=function(){if(!B){return}var s=this;s.imgCount=0;s.imgLoaded=0;zm(v).css("height",Math.min(n.scrollHeight,this.maxHeight)+"px").find("img").each(function(){if(this.dataset.loaded!=1&&!this.complete){s.imgCount++;this.onload=function(){s.imgLoaded++;s.imgLoaded>=s.imgCount&&s.updateHeight()};this.dataset.loaded=1}})};this.enableScrollTop=function(){B=true};this.disableScrollTop=function(){B=false;zm(v).css("height","")};this.getElement=function(){return v};this.getGripper=function(){return f};this.getScrollbar=function(){return a};this.updateScrollbar=function(){x(true);return this};this.switchScrollbar=function(s){if(!zm.support.CSSAnimation){s?zm(a).removeClass("small").addClass("hasbg large"):zm(a).removeClass("large hasbg").addClass("small");return}A=s?"large":"small";if(!w){zm(a).removeClass("large small").addClass("hasbg "+A);A=null}};this.scrollTo=function(s,G,z){if(i.scrollTop!=s){t=!z;i.scrollTop=s;setTimeout(function(){t=false},100)}return this};this.scrollToEnd=function(s){return this.scrollTo(i.scrollHeight,null,s)};this.scrollToBottom=function(s){return this.scrollTo(i.scrollHeight,null,s)};this.scrollToTop=function(s){return this.scrollTo(0,null,s)};this.scrollTop=function(s){if(s==undefined){return i.scrollTop}i.scrollTop=s;return this};this.scrollLeft=function(s){if(s==undefined){return i.scrollLeft}i.scrollLeft=s;return this};this.showScrollbar=function(){x(true);return this};this.hideScrollbar=function(s){c();if(s){g()}else{m()}return this};this.show=function(){zm(v).show();return this};this.hide=function(){zm(v).hide();return this};this.clear=function(){zm(y).empty();return this};this.remove=function(){zm(v).remove();E.disconnect()};l.data("scrollableObject",this)};zm(document).mousemove(function(i){var f=zm.ScrollableUI.draggingObj;if(f){var m=zm.getMousePosition(i).top,o=f.getGripper(),h=zm(o),p=h.outerHeight(),j=h.parent(),a=j.height(),l=m-j.top()-(f.offsetY||0),c=l<=0||l>=a-p;if(l<0){l=0}if(l>a-p){l=a-p}var n=j.parent().children().get(0)[0];if(!zm.browser.msie){n.scrollTop+=1;n.scrollTop-=1}if(c&&l>0){n.scrollTop=n.scrollHeight}else{n.scrollTop=zm.intval(l*(n.scrollHeight-n.offsetHeight)/(a-p))}}var b=zm.ScrollableUI.movingUI;if(b){var k=b.getElement();if(this==k){return}var d=true;zm(this).parents().each(function(){if(this==k){d=false;return false}});if(d){b.hideScrollbar(true);zm.ScrollableUI.movingUI=null}}}).mouseup(function(){var a=zm.ScrollableUI.draggingObj;if(a){if(this!=a.getScrollbar()&&this!=a.getGripper()){if(a.settings.alwaysShow){a.switchScrollbar(false)}else{a.hideScrollbar()}}a.mousedown=false;a.offsetY=null;zm.ScrollableUI.draggingObj=null}});zm(document.documentElement).mousewheel(function(h){if((typeof h.axis!=="undefined"&&h.axis===h.HORIZONTAL_AXIS)||(h.wheelDeltaX&&!h.wheelDeltaY)){h.preventDefault()}else{if(zm.ScrollableUI.scrollingElement){var m=h.wheelDeltaY||h.wheelDelta||h.detail,a=zm.ScrollableUI.scrollingElement,f=a.scrollHeight,n=a.offsetHeight,l=zm(a).parents();for(var c=0,b;b=l.get(c);c++){if(b.css("display")=="none"){zm.ScrollableUI.scrollingElement=null;return}}if(f>n){var k=a.scrollTop;if(((zm.browser.firefox?m<0:m>0)&&k==0)||((zm.browser.firefox?m>0:m<0)&&k>=f-n)){h.preventDefault()}else{if(zm.browser.msie&&zm.browser.version<9){var g=zm(a).css("font-size");if(g.indexOf("px")<0){var j=zm.createElement("DIV");j.style.fontSize=g;j.style.height="1em";g=j.style.pixelHeight}else{g=parseInt(g,10)}a.scrollTop=k-Math.round(m/120*g);h.preventDefault()}}}}}});if(zm.browser.msie){zm(document).bind("selectstart",function(){var a=zm.ScrollableUI.draggingObj;if(a&&a.mousedown){return false}})}zm.ScrollableUI.defaultSettings={}});zm.install("fixedbox",null,function(){zm.plugins.fixedbox.defOptions={closeButton:true,content:"",footer:false,onscroll:false,modal:true,boxClass:"",scrollable:true,footerClass:"",bodyClass:"",coverClass:"",mainView:".zmviewport"};zm.plugins.fixedbox.count=0;zm.FixedBox=function(l){var d,k=this,f=false,g,j,i,a=zm.extend({},zm.plugins.fixedbox.defOptions,l),e=zm.plugins.fixedbox.count++;var c=a.header===false?"":'<div class="fixedbox_top">				<div class="fixedbox_title"'+(a.title?"":' style="display: none"')+'>					<div class="fbxpad">						<div class="fixedbox_close">							<a class="" title="Đóng" href="#"></a>						</div>						<div class="newsprv_actlink"'+(a.rightHeader?"":' style="display: none"')+">"+a.rightHeader+'</div>						<p class="fixedbox_titletext">'+a.title+'</p>						<div class="clr"></div>					</div>					<div class="clr"></div>				</div>			</div>',h=a.footer===false?"":'<div class="fixedbox_footer '+a.footerClass+'">				<div class="fixedbox_botcont fbxpad"'+(a.footer?"":' style="display: none"')+">					"+a.footer+'					<div class="clr"></div>				</div>			</div>',b='<div class="fixedbox_wrapper '+a.boxClass+'">				<div class="fixedbox_body '+a.bodyClass+'">'+c+'<div class="fixedbox_content fbxpad">						<div class="fixedbox_content_inner"></div>					</div>				</div>'+h+"</div>";var d=zm(zm.createElement("DIV",{"class":"fixedbox_overlay "+a.coverClass},{display:"none"})).html(b);document.body.appendChild(d[0]);if(a.scrollable){j=new zm.ScrollableUI({content:a.content,onscroll:a.onscroll});d.find(".fixedbox_content_inner").append(j.getElement())}else{d.find(".fixedbox_content_inner").html(a.content)}d.find(".fixedbox_close").click(function(){k.hide();return false});d.click(function(){if(zm(this).hasClass("fixedbox_overlay")||zm(this).hasClass("fixedbox_wrapper")){k.hide()}});this.getElement=function(){return d};this.getSettings=function(){return a};this.show=function(){zm.plugins.fixedbox.activeInstance=this;zm.isFunction(a.beforeShow)&&a.beforeShow.call(this);g=zm(window).scrollTop();zm(a.mainView).css("top",-g+"px");zm(document.body).css("overflow","hidden");d.show();f=true;this.resizeContent();zm.isFunction(a.afterShow)&&a.afterShow.call(this);zm.Key.queueDocEscape("fixedbox"+e)};this.hide=function(){zm.plugins.fixedbox.activeInstance=null;zm.isFunction(a.beforeHide)&&a.beforeHide.call(this);zm(a.mainView).css("top","");zm(document.body).css("overflow","");zm(window).scrollTop(g);d.hide();f=false;zm.isFunction(a.afterHide)&&a.afterHide.call(this);zm.Key.queueDocEscape("fixedbox"+e)};this.close=function(){this.hide()};this.isShowing=function(){return f};this.resizeContent=function(){var m=d.find(".fixedbox_content");i=d.height()-d.find(".fixedbox_top").outerHeight(true)-d.find(".fixedbox_footer").outerHeight(true)-zm.intval(m.css("padding-top"))-zm.intval(m.css("padding-bottom"))-zm.intval(m.css("margin-top"))-zm.intval(m.css("margin-bottom"));if(j){j.setWidth(m.width());j.setHeight(i)}else{m.find(".fixedbox_content_inner").css("height",i+"px")}zm.isFunction(a.onresize)&&a.onresize(i)};this.getContentHeight=function(){return i};this.setTitle=function(n){var m=d.find(".fixedbox_titletext");if(!m.length){return}if(n===false){m.hide()}else{m.text(n).show()}this.resizeContent()};this.setRightHeader=function(m){var n=d.find(".fixedbox_titletext .newsprv_actlink");if(!n.length){return}if(!m){n.hide()}else{n.html(m).show()}};this.setContent=function(m){if(j){j.setContent(m)}else{d.find(".fixedbox_content_inner").empty().append(m)}};this.setFooter=function(n){var m=d.find(".fixedbox_botcont");if(!m.length){return}if(n===false){m.hide()}else{m.empty().append(n).show()}this.resizeContent()};zm.Key.bindDocEscape("fixedbox"+e,this.hide)};zm(window).resize(function(){zm.plugins.fixedbox.activeInstance&&zm.plugins.fixedbox.activeInstance.resizeContent()})});zm.install("form",{ajaxSubmit:function(a){var b=this[0];if(!b||b.nodeName.toLowerCase()!="form"){return this}this.submit(function(){var d=(a&&a.action)||b.getAttribute("action"),h=(a&&a.dataType)||"text/html",f=a&&a.beforeSubmit,j=a&&a.beforeGetData,c=b.getAttribute("method")||"GET",i=(a&&a.success)||undefined,g=(a&&a.error)||undefined;typeof j=="function"&&j(b);var k=true,e=zm.plugins.form.getData(b,a);typeof a.postData=="function"&&(e=a.postData(e));if(typeof f=="function"){k=f(b)}k!==false&&zm.ajax({method:c.toUpperCase(),url:d,data:e,dataType:h,success:i,error:g});return false});return this},resetForm:function(){if(!this[0]){return}var c=this[0].elements;for(var a=0,d;d=c[a];a++){d.disabled=false;switch(d.nodeName.toLowerCase()){case"input":var b=d.type;if(b=="text"||b=="password"||b=="file"){d.value=""}else{if(b=="checkbox"||b=="radio"){d.checked=false}}break;case"textarea":case"select":d.selectedIndex=0;break;default:break}}return this},handleInput:function(){if(!this.length){return this}var a=this.addClass("zmform").find('input[data-required="true"],textarea[data-required="true"]');a&&a.size()>0&&a.keyup(zm.plugins.form.handleInput).change(zm.plugins.form.handleInput).bind("zminsertatcaret",zm.plugins.form.handleInput).bind("paste",zm.plugins.form.handleInputClipboard).bind("cut",zm.plugins.form.handleInputClipboard);return this}},function(){zm.plugins.form.getData=function(d,a){var g=d.elements,f={};for(var b=0;b<g.length;b++){var h=g[b];if(!a.getDisabled&&h.disabled==true){continue}switch(h.nodeName.toLowerCase()){case"input":var c=h.type,j="";if(c=="text"||c=="password"||c=="file"||c=="hidden"){j=h.value}else{if(c=="checkbox"){h.checked&&(j=h.value)}else{if(c=="radio"){if(a.getUnCheckedRadio){j=h.value}else{h.checked&&(j=h.value)}}}}j&&h.name&&(f[h.name]=j);break;case"textarea":case"select":h.name&&(f[h.name]=h.value);break;default:break}}return f};zm.plugins.form.checkInput=function(a){var b=true;a.each(function(){if(!this.value){b=false;return false}});return b};zm.plugins.form.setButton=function(a,b,c){if(!b||b.length<1){return}c=c||"disable";b[a?"addClass":"removeClass"](c)};zm.plugins.form.handleInput=function(){var d=zm(this).parents(".zmform"),b=d.find('input[data-required="true"],textarea[data-required="true"]'),f=zm.plugins.form.checkInput(b),e=d.attr("data-submitbutton")||".zmform_submit",a=d.attr("data-disablebutton"),c=d.find(e);zm.plugins.form.setButton(!f,c,a)};zm.plugins.form.handleInputClipboard=function(){var a=this;setTimeout(function(){zm.plugins.form.handleInput.call(a)},10)}});zm.install("tagfriend",{tagFriend:function(a,b){var c=this;if(typeof zmCacheFriends!="undefined"){zm.plugins.tagfriend.attach(c,a,b)}else{if(typeof zmFriendTag!="undefined"&&zmFriendTag.url){zm.plugins.tagfriend.elems.push([c,a,b]);if(!zm.plugins.tagfriend.getting){zm.plugins.tagfriend.getting=true;var d=(window==top)?"get":"getJSON";zm[d](zmFriendTag.url,{dataType:"json"},function(g){zmCacheFriends=g;for(var f=0,e;e=zm.plugins.tagfriend.elems[f];f++){zm.plugins.tagfriend.attach(e[0],e[1],e[2])}delete zm.plugins.tagfriend.elems;delete zm.plugins.tagfriend.getting})}}}}},function(){zm.tagfriend={getFriendInfo:function(b,c){var e=null;if(typeof zmCacheFriends!="undefined"){for(var a=0,d;d=zmCacheFriends[a];a++){if(b==d[c||0]){e=d;break}}}return e},addTaggedFriend:zm.plugins.tagfriend.addFriend};zm.plugins.tagfriend.cacheTime=7*24*3600;zm.plugins.tagfriend.attach=function(g,a,c){var b=g,e={minChars:1,followElement:a,formatItem:function(k){if(k==1){zm(arguments[4]).attr("class","").css({height:"20px",cursor:"default"});return"Nhập tên người bạn muốn tìm..."}k=k.v;var f=false;if(c&&zm.isFunction(c.checkExist)){f=c.checkExist(k)}else{var i=b.data("tagfriend.prefix");if(b.val().indexOf(i+k[1])>=0){f=true}else{if(c&&c.displayParticipant){f=false;b.parents(".zmtagfriend").find(".zmtagfriend_participant").each(function(){if(zm(this).attr("data-uid")==k[0]){f=true;return false}})}}}if(f){return false}var l="tagf_"+k[0];zwg.addItem(l,"ZMEA_"+k[0]+"?id=1&width=34&height=34&size=50");return'<span id="'+l+'"></span><p>'+k[2]+"</p>"},beforeShow:function(f){zm.data(f,"tagfriend.processing",true);zwg.fillWg()},beforeHide:function(f){zm.data(f,"tagfriend.processing",false)},search:function(n,m,l){var r=b.data("tagfriend.prefix");if(m==r){return[1]}if(r&&m.indexOf(r)==0){m=m.substr(1)}m=zm.rtrim(m.toLowerCase());var v,o,s,t=zm.storage.get("zmtagfriend.marked."+zmConfig.viewerId);if(l){v=n;for(o=0;s=n[o];o++){s.w=(t&&t[s.v[0]]&&-t[s.v[0]])||s.w}}else{v=[];for(o=0;s=zmCacheFriends[o];o++){var q=s[2].toLowerCase(),u=t&&t[s[0]]&&-t[s[0]],p=q.indexOf(m),k,f=null;if(p>=0){f=zm.plugins.tagfriend.getWeight(q,p);f!=null&&v.push({v:s,k:s[2],w:u||f})}else{if(s[1].toLowerCase().indexOf(m)==0){v.push({v:s,k:s[1],w:u||6})}else{if((k=ViString.indexOf(m,q))>=0){f=zm.plugins.tagfriend.getWeight(q,k,true);f!=null&&v.push({v:s,k:s[2],w:u||f})}}}}}v.sort(zm.plugins.tagfriend.sortCallback);return v},selectFirst:true,highlight:false,delay:(zm.browser.msie&&zm.browser.version<8)?300:50,inView:true,activeItemClass:"hover",listClass:"listag"};var j=b[0].nodeName.toLowerCase();if(j!="input"&&j!="textarea"){b=g.find("input,textarea")}e.getTerm=function(i){var k=zm.data(i,"tagfriend.prefix"),l=zm.plugins.tagfriend.getText(i,k),f="";if(l&&l.length>1&&l[0].indexOf(k)==0){f=l[0]}zm.data(i,"tagfriend.term",l);return f};e.formatInput=function(l){var i=zm.data(this,"tagfriend.term"),k=zm.data(this,"tagfriend.prefix"),f=i[0].length-k.length,m=i[1];zm.plugins.tagfriend.replace(this,f,m-f,l.v[1],k);return true};e.onItemSelected=function(){var f=arguments[1].v;f==1&&zm.plugins.autocomplete.hide();c&&c.displayParticipant&&zm.plugins.tagfriend.addFriend(b,f,c);zm.plugins.tagfriend.markUser(f[0]);c&&zm.isFunction(c.onItemSelect)&&c.onItemSelect(f)};b.data("tagfriend.prefix",(!c||c.prefix===undefined)?"@":c.prefix);if(c){e.zIndex=c.zIndex;e.scrollHeight=c.scrollHeight;e.position=c.position;e.coverClass=c.coverClass;if(c.displayParticipant){e.formatInput=function(){this.value=""};b.parents(".zmtagfriend").click(function(){var f=zm(this);if(f.attr("rel")=="tagfriend"){b.focus()}}).on("click",".zmtagfriend_remove",function(f){f.preventDefault();zm(this).parents(".zmtagfriend_participant").remove();zm.isFunction(c.onRemove)&&c.onRemove(zm(this).attr("data-info").split("|"))});b.keydown(function(i){if(i.keyCode==8&&this.value.length==0){var f=zm(this).parents(".zmtagfriend").find(".zmtagfriend_participant");f.size()&&f.get(":last").find(".zmtagfriend_remove").click()}})}if(c.taggedFriends){for(var d=0,h;h=c.taggedFriends[d];d++){zm.plugins.tagfriend.addFriend(b,zm.tagfriend.getFriendInfo(h),c)}}}b.enableAutocomplete(zmCacheFriends,e)};zm.plugins.tagfriend.markUser=function(b){var a="zmtagfriend.marked."+zmConfig.viewerId,d=zm.storage.get(a);if(!d){d={timestamp:new Date().getTime()}}var c=d[b];if(!c){c=0}c++;d[b]=c;zm.storage.put(a,d,zm.plugins.tagfriend.cacheTime)};zm.plugins.tagfriend.addFriend=function(b,d,a){var c;if(zm.isFunction(a.formatParticipant)){c=a.formatParticipant(d)}else{c='<span class="usertag zmtagfriend_participant" data-uid="'+d[0]+'">'+d[2]+'<em class="zmico zmtagfriend_remove" data-info="'+d.join("|")+'"></em>				</span>'}b.parents(".zmtagfriend").find(".zmtagfriend_participantlist").append(c)};zm.plugins.tagfriend.getText=function(i,h){var c="",a="";if(document.selection){var j=i.document.selection.createRange();if(j.text){j.text=""}else{while(true){j.moveStart("character",-1);if(c.length==j.text.length){break}c=j.text;if("\\\r\n#,;.:-_()<>+-*/=?!\"$%{}[]'~|^@&\t".indexOf(c.charAt(0))>=0){break}}}if(c.length){j.collapse(false);j.moveStart("character",-c.length);i.cW=j.duplicate();return[i.cW.text,0]}else{return false}}else{var d,k,f=1;d=i.value;if(d.length<=0||!i.setSelectionRange){return false}k=i.selectionStart;if(i.selectionStart!=i.selectionEnd){return["",k]}while(true){a=d.substr(k-f,1);if(k-f<0){break}else{if("\\\r\n#,;.:-_()<>+-*/=?!\"$%{}[]'~|^@&\t".indexOf(a)>=0){if(h&&a==h){c=a+c}break}else{c=a+c}}f++}return[c,k]}};zm.plugins.tagfriend.replace=function(e,d,h,c,f){var a=c.length;if(document.selection){e.cW.text=f+c}else{var g=e.selectionStart,b=e.scrollTop;e.value=e.value.substr(0,h)+c+e.value.substr(h+d);e.setSelectionRange(g-d+a,g-d+a);e.scrollTop=b}};zm.plugins.tagfriend.sortCallback=function(d,c){var e=d.w<0?d.v[2]:d.k,f=c.w<0?c.v[2]:c.k;if(d.w==c.w){return zm.trim(e.toLowerCase())>zm.trim(f.toLowerCase())?1:-1}else{if(d.w>c.w){return 1}else{return -1}}};zm.plugins.tagfriend.getWeight=function(c,d,b){var a=null;if(d==0){a=0}else{if(c.charAt(d-1)==" "){if(c.indexOf(" ",d)>0){a=1}else{a=2}}}if(b&&a!=null){a+=3}return a};zm.plugins.tagfriend.elems=[]});zm.ready(function(){var b="zmtagfriend.marked."+zmConfig.viewerId,c=zm.storage.get(b);if(c&&c.timestamp){var a=new Date().getTime();if(a-c.timestamp>1000*zm.plugins.tagfriend.cacheTime){zm.storage.remove(b)}}});zm.install("photoviewer",null,function(){var a,b=0;zm.PhotoViewer=function(n){b++;n=zm.extend({},n);var g,c="photoviewer"+b,h="",m="",e="",k=true,d=true;if(n.photoHeader){h='<div class="topaction '+(n.photoHeaderClass?n.photoHeaderClass:"")+'">'+n.photoHeader+"</div>"}else{h='<div class="topaction" style="display: none"></div>'}if(n.photoFooter){m='<div class="botinfo '+(n.photoFooterClass?n.photoFooterClass:"")+'">'+n.photoFooter+"</div>"}else{m='<div class="botinfo" style="display: none"></div>'}if(n.rightContent){e='<div class="infophoto '+(n.rightContentClass?n.rightContentClass:"")+'">'+n.rightContent+"</div>"}g=new zm.FixedBox(zm.extend({header:false,footer:false,scrollable:false,bodyClass:"photolbx",content:'<div id="'+c+'" class="photolbx_cont '+(n.contentClass?n.contentClass:"")+'">				<div class="ctnphoto">'+h+'<div class="stagephoto unselectable">						<a class="nav next" style="cursor: pointer; display: none"><span class="photolbx_sprt iconextphoto"></span></a>						<a class="nav prev" style="cursor: pointer; display: none"><span class="photolbx_sprt icoprephoto"></span></a>						<div class="ctnimage"><img src="" alt="" /></div>					</div>'+m+"</div>"+e+'<a href="#"><span class="photolbx_sprt hideviewer icodelbig"></span></a>				<div class="clr"></div>			</div>'},n));zm("#"+c+" .stagephoto").mousemove(function(s){var o=zm(this);if(!o.hasClass("stagephoto")){o=o.parents(".stagephoto")}var r=f(s,o),q=o.find(".prev span"),p=o.find(".next span");q[r?"addClass":"removeClass"]("selphoto");p[r?"removeClass":"addClass"]("selphoto");if((k&&r)||(d&&!r)){o.css("cursor","pointer")}else{o.css("cursor","")}}).mouseenter(function(){zm(this).find(".prev")[k?"show":"hide"]();zm(this).find(".next")[d?"show":"hide"]()}).mouseleave(function(){zm(this).find(".nav").hide().find("span").removeClass("selphoto")}).click(function(q){var p=zm(this);if(p.hasClass("nav")||p.parent().hasClass("nav")){return}if(!p.hasClass("stagephoto")){p=p.parents(".stagephoto")}var o;if(f(q,p)){o=p.find(".prev span")}else{o=p.find(".next span")}!o.is(":hidden")&&o.click()});zm("#"+c+" .stagephoto .prev").click(function(){k&&zm.isFunction(n.back)&&n.back();return false});zm("#"+c+" .stagephoto .next").click(function(){d&&zm.isFunction(n.forward)&&n.forward();return false});zm("#"+c+" .hideviewer").click(function(){g.hide();a=null;return false});function f(q,p){var r=zm.getMousePosition(q),o=p.left()+p.width()/2;return r.left<o}function i(){var o=zm("#"+c+" .stagephoto img"),p=l();o.css({width:p.width+"px",height:p.height+"px"});o.parent().css({width:p.width+"px",height:p.height+"px"});zm.isFunction(n.onPhotoScale)&&n.onPhotoScale.call(o,p.width,p.height);return p}function l(x,t){var p=g.getContentHeight()-zm("#"+c+" .topaction").outerHeight(true)-zm("#"+c+" .botinfo").outerHeight(true)-zm.intval(zm("#"+c+" .stagephoto").css("margin-top"))-zm.intval(zm("#"+c+" .stagephoto").css("margin-bottom"))-zm.intval(zm("#"+c+" .stagephoto").css("padding-top"))-zm.intval(zm("#"+c+" .stagephoto").css("padding-bottom")),u=zm("#"+c+" .stagephoto").width(),s=zm("#"+c+" .stagephoto img"),r=t||s.data("height"),q=x||s.data("width"),v=Math.min(p/r,u/q),o,y;if(p>r&&u>=q){o=q;y=r}else{o=Math.floor(q*v);y=Math.floor(r*v)}return{width:o,height:y}}function j(){g.hide();zm.isFunction(n.onHide)&&n.onHide.call(g);a=null}zm.Key.bindDocEscape("photoviewer"+b,j);return{getId:function(){return c},getPhotoHeader:function(){return zm("#"+c+" .topaction")},getPhotoFooter:function(){return zm("#"+c+" .botinfo")},show:function(){g.show();zm.isFunction(n.onShow)&&n.onShow.call(g);a=this},hide:j,isShowing:g.isShowing,setPhoto:function(p){var o=zm("#"+c+" .stagephoto");o.find("img").attr("src",p);o.css("visibility",p?"":"hidden")},getPhoto:function(){return zm("#"+c+" .stagephoto img").attr("src")},setPhotoSize:function(q,o){var p=zm("#"+c+" .stagephoto img");q&&p.data("width",q);o&&p.data("height",o);return i()},getPhotoSize:l,setPhotoHeader:function(o){zm("#"+c+" .topaction").html(o)},setPhotoFooter:function(o){zm("#"+c+" .botinfo").html(o)},showNavigation:function(){zm("#"+c+" .stagephoto .nav").show()},hideNavigation:function(){zm("#"+c+" .stagephoto .nav").hide()},showBackNavigation:function(){zm("#"+c+" .stagephoto .prev").show()},hideBackNavigation:function(){zm("#"+c+" .stagephoto .prev").hide()},showForwardNavigation:function(){zm("#"+c+" .stagephoto .next").show()},hideForwardNavigation:function(){zm("#"+c+" .stagephoto .next").hide()},enableNavigation:function(){this.enableBackNavigation();this.enableForwardNavigation()},disableNavigation:function(){this.disableBackNavigation();this.disableForwardNavigation()},enableBackNavigation:function(){k=true;this.showBackNavigation()},disableBackNavigation:function(){k=false;this.hideBackNavigation()},enableForwardNavigation:function(){d=true;this.showForwardNavigation()},disableForwardNavigation:function(){d=false;this.hideForwardNavigation()},back:function(){zm("#"+c+" .stagephoto .prev").click()},forward:function(){zm("#"+c+" .stagephoto .next").click()},resize:function(){i();zm.isFunction(n.onresize)&&n.onresize()}}};zm(document).keyup(function(c){if(!a||!a.isShowing()){return}if(c.keyCode==37){a.back()}else{if(c.keyCode==39){a.forward()}}});zm(window).resize(function(){a&&a.resize()})});zm.install("selectbox",{},function(){var a={titleClass:"",selectedClass:"",iconClass:"",listClass:""};zm.SelectBox=function(e){e=zm.extend({},a,e);var f='<div class="seltitle">				<span class="catesel '+e.selectedClass+'"></span>				<span class="zmsprt icoarrowsel '+e.iconClass+'"></span>			</div>			<ul class="itemscatesel '+e.listClass+'" style="display: none"></ul>',g=zm.createElement("DIV",{"class":"bxcatesel"+(e.selectboxClass?" "+e.selectboxClass:"")}),c=0,h;zm(g).html(f).children(".seltitle").click(function(){zm(g).children("ul.itemscatesel").toggle()}).clickOutside(function(){zm(g).children("ul.itemscatesel").hide()}).clickOutsideWith(zm(g).children("ul.itemscatesel"));zm(g).children("ul.itemscatesel").click(function(){var i=this;if(!/^li$/i.test(i.nodeName)){i=i.parentNode}b(zm.inArray(i,zm(i).parent().children()));zm(g).children("ul.itemscatesel").hide();return false});function d(m){var k="";for(var j=0,l;l=m[j];j++){k+='<li data-val="'+l.value+'"><a href="#">'+l.name+"</a></li>"}zm(g).children("ul.itemscatesel").html(k);b(0)}function b(i){var j=zm(g).children("ul.itemscatesel").children("li").get(i);if(!j){return}c=i;h=j.attr("data-val");zm(g).find(".catesel").html(j.text());zm.isFunction(e.onSelect)&&e.onSelect(h)}e.list&&d(e.list);return{getElement:function(){return g},setList:d,val:function(i){if(i){zm(g).children("ul.itemscatesel li").each(function(j){if(i==zm(this).attr("data-val")){c=j;h=zm(this).text();zm(g).find(".catesel").html(h);return false}});return}return h},select:b,getSelectedIndex:function(){return c}}}});zm.install("simplepreviewer",{},function(){var b,a;var c={onClose:null,modal:false,mainClass:""};zm.showSimpleViewer=function(h,g){a=zm.extend({},c,g);zm(".zmspviewer_wrapper").remove();var f=zm.createElement("DIV",{"class":"zmspviewer_wrapper "+a.mainClass}),i=zm.createElement("DIV",{"class":"zmspviewer"}),e=zm.createElement("DIV",{"class":"zmspviewer_container"}),d=zm.createElement("DIV",{"class":"zmspviewer_content"});zm(d).html(h);e.appendChild(d);i.appendChild(e);f.appendChild(i);document.body.appendChild(f);b=zm(f);if(!a.modal){zm(i).click(function(){if(zm(this).hasClass("zmspviewer_content")||zm(this).parents(".zmspviewer_content").length>0){return}zm.hideSimpleViewer();zm.Key.dequeueDocEscape("spviewer")})}zm.Key.queueDocEscape("spviewer")};zm.hideSimpleViewer=function(){zm.isFunction(a.onClose)&&a.onClose.call(this);b&&b.remove();b=null};zm.Key.bindDocEscape("spviewer",zm.hideSimpleViewer)});zm.install("brickbox",{autoArrangeBox:function(m){var J=this.children();if(m&&m.filterItem){J.filter(m.filterItem)}if(!J||J.size()<1){return this}if(this.data("brickbox.autoresize")!=1){zm.plugins.brickbox.elems.push({element:this,options:m});this.data("brickbox.autoresize",1)}m=zm.extend({},zm.plugins.brickbox.defSettings,m);var q=this.parent().parent(),H=q.offset().left,D=zm.intval(m.from),c=m.force||D>0;if(H<0&&!c){return this}var d=m.getMaxWidth,z=(zm.isFunction(d)&&d.call(this))||(q.width()-H-20),o=0,K=m.padding,p=m.paddingBottom||K,v=m.paddingRight||K,L=m.minColumn,n,t,a=[],F,I,f,N=0;for(F=0,I;I=J.get(F);F++){var s=I.outerWidth();if(s>0){n=s+v;break}}t=Math.floor((z+v)/n);if(t==zm.intval(this.data("brickbox.cols"))&&!c){return this}var u=m.beforeArrange;zm.isFunction(u)&&u(t,n,z);if(t<L&&!c){return this}this.data("brickbox.cols",t);if(D>0){for(F=D-1;I=J.get(F);F--){if(a.length>=t){break}if(!f){f=new Array()}var y=I.outerHeight();if(y>0){var B=zm.intval(I.css("left")),M=zm.intval(I.css("top"))+y;if(f.length==0){f.push(B);a.push(M)}else{var C=-1;for(var E=0;E<f.length;E++){if(f[E]==B){break}if(f[E]<B){if(E==f.length-1){C=E+1}continue}if(f[E]>B){C=E;break}C=0}if(C>-1){f.splice(C,0,B);a.splice(C,0,M)}}}}}for(F=D;I=J.get(F);F++){var x=0,G=I.outerHeight();if(G==0){continue}if(a.length<t){o=a.length%t*n;if(D>0&&f.length<t){f.push(o)}a.push(G)}else{var r=Math.min.apply(Math,a),A=zm.inArray(r,a);x=r+p;if(D>0&&f){o=f[A]}else{o=A*n}a[A]=x+G}I.css({top:x+"px",left:o+"px"}).attr("data-index",F);N++}this.css("height",Math.max.apply(Math,a)+"px").parent().css("width",(t*n-v)+"px");D==0&&this.data("brickbox.total",N);var g=m.afterArrange;zm.isFunction(g)&&g(t,n,z);return this},getNumberBoxColumns:function(){return this.data("brickbox.cols")},getNumberBoxes:function(){return this.data("brickbox.total")},updateTopBox:function(m){var j=this.children();if(m&&m.filterItem){j.filter(m.filterItem)}if(!j||j.size()<1){return this}m=zm.extend({},zm.plugins.brickbox.defSettings,m);var l=zm.intval(m.from),f=m.paddingBottom||m.padding,a,k;for(var b=l,g;g=j.get(b);b++){var d=g.outerHeight();if(d==0){continue}var c=zm.intval(g.css("left"));if(a===undefined){a=c}else{if(a!=c){continue}}if(k){g.css("top",(k+f)+"px")}k=zm.intval(g.css("top"))+d}if(this.height()<k){this.css("height",k+"px")}return this}},function(){zm.plugins.brickbox.defSettings={padding:10,force:false,from:0};zm.plugins.brickbox.elems=[];zm(window).resize(function(){for(var a=0,b;b=zm.plugins.brickbox.elems[a];a++){b.options.force=false;b.from=0;b.element.autoArrangeBox(b.options)}})});zm.install("uploadphoto",{addUploadPhoto:function(p){var a=p.maxSize,d=p.maxFile,i,k,c=!!window.FormData;zm(p.form).find(".photoFile").change(function(q){if(c){b(q.target.files||q.dataTransfer.files)}else{h()}});zm(p.container).on("click",".photoAddmore",function(q){q.preventDefault();zm(p.form).find(".photoFile").click()});zm(p.container).find(".thumbContainer").on("click",".delphoto",function(){var r=zm(this).parents(".photo_thumb"),q=r.attr("data-pid"),s=p.getDeleteUrl&&p.getDeleteUrl(q);r.remove();if(!s){zm.plugins.uploadphoto.delThumb(q,p)}else{zm.post(s,{pid:q,sign:zmConfig.signkey,ts:zmConfig.time},{dataType:"json"},function(){zm.plugins.uploadphoto.delThumb(q,p)})}});if(!c){zmXCall.register("photoUploaded",e)}function n(q){if(!/^(image\/gif|image\/jpeg|image\/png)$/i.test(q.type)){return false}if(q.size>a){return false}return true}function b(s){var u=zm(p.container).find(".thumbContainer .photo_thumb").size();for(var q=0,t;t=s[q];q++){var r=n(t);if(!r){continue}if(r){u++}if(u>d){break}(u==0||!i)&&j();o(t,zm.plugins.uploadphoto.count++)}zm.isFunction(p.onProcessFile)&&p.onProcessFile(u)}function h(){!i&&j();var q=zm("#statusbox_previewphoto .uphotowall"),r=zm.plugins.uploadphoto.count++;zm("#statusbox_previewphoto .uphotowall").append('<li id="photopreview_'+r+'" class="photo_thumb loading"><a href="#"><img width="52" src="'+zmConfig.IMAGE_URL+'/loading_photo.gif" alt="" /></a></li>');zm("#statusbox_previewphoto .uphotowall .addmore").remove();q.find("li.photo_thumb").length<d&&zm("#statusbox_previewphoto .uphotowall").append('<li class="addmore"><a href="#" title="Nhấn để chọn ảnh"><em><span class="stt_icosprt icoadd"></span></em></a></li>');zm.isFunction(p.setInputFilePosition)&&p.setInputFilePosition()}function o(r,q){var t=zm(p.form)[0],u=new FormData(t),v=new XMLHttpRequest();if(p.getUploadUrl){t.action=p.getUploadUrl()}u.append("Filedata",r);v.withCredentials=true;v.upload.addEventListener("progress",f,false);v.upload.fileOrder=q;v.fileOrder=q;v.addEventListener("load",g,false);v.addEventListener("error",m,false);v.addEventListener("abort",l,false);v.open("POST",t.action);v.send(u);var s="";if(p.formatPreviewItem){s=p.formatPreviewItem(q)}else{s='<a href="#"><span class="ctnprobar"><span class="probar" style="width:0%"></span></span></a>'}zm(p.container).find(".thumbContainer").append('<li id="photopreview_'+q+'" class="photo_thumb loading">'+s+"</li>");zm.isFunction(p.beforeUpload)&&p.beforeUpload(q)}function f(r){var q=Math.floor(r.loaded/r.total*100);if(q>100){q=100}else{if(q<0){q=0}}zm("#photopreview_"+r.target.fileOrder+" .probar").css("width",q+"%");zm.isFunction(p.onUploading)&&p.onUploading(r.target.fileOrder,q)}function g(q){var s=q.target;if(s.status==200){var r=zm.parseJSON(s.responseText);zm.isFunction(p.uploadSuccess)&&p.uploadSuccess(s.fileOrder,r);if(r.error_code==0||r.error==0){zm.plugins.uploadphoto.addThumbInfo(r,s.fileOrder,p)}else{zm.plugins.uploadphoto.showUploadFail(s.fileOrder)}}zm.isFunction(p.uploadFinish)&&p.uploadFinish(q)}function m(q){zm.isFunction(p.uploadError)&&p.uploadError(q)}function l(q){zm.isFunction(p.uploadAbort)&&p.uploadAbort(q)}function e(q){if(q.error_code!=0){return}zm.plugins.uploadphoto.addThumbInfo(q,zm.plugins.uploadphoto.count-1,p)}function j(){var q=zm(p.container),r=q.attr("data-previewing");if(r==1){i=true;zm(p.container).attr("data-previewing","")}if(i){return}i=true;k={};if(q.find(".thumbContainer").size()){zm.plugins.uploadphoto.delAllThumbs(p);q.find(".thumbContainer").empty()}zm.plugins.uploadphoto.updateText(true,p)}},addUploadedPhotos:function(d){var a=zm(d.container).find(".thumbContainer");for(var e=0,b;b=d.images[e];e++){var c=zm.plugins.uploadphoto.count,f="";if(d.formatItem){f=d.formatItem(c,b)}a.append('<li id="photopreview_'+c+'" class="photo_thumb loading">'+f+"</li>");zm.plugins.uploadphoto.addThumbInfo({src:b.src,pid:b.pid,aid:b.aid},c,d);zm.plugins.uploadphoto.count++}zm(d.container).show().attr("data-previewing","1")}},function(){zm.plugins.uploadphoto.count=0;zm.plugins.uploadphoto.addThumbInfo=function(e,c,b){var d=e;if(b.getData){d=b.getData(e)}zm.plugins.uploadphoto.loadImage(d.src,c,b.onPhotoLoaded);var a=zm("#photopreview_"+c);d.pid&&a.attr("data-pid",d.pid);d.aid&&a.attr("data-aid",d.aid);a.html(b.photoLoadingItem);zm.plugins.uploadphoto.updateText(false,b)};zm.plugins.uploadphoto.loadImage=function(e,b,c,d){d=d||0;if(d>10){zm("#photopreview_"+b).removeClass("loading").find("img").attr("src",zmConfig.IMAGE_URL+"/imgphotothumb.jpg");zm.plugins.uploadphoto.checkUploadFinished();return}d++;var a=new Image();a.times=d;a.onload=function(){zm("#photopreview_"+b).removeClass("loading").find("img").attr("src",this.src);zm.isFunction(c)&&c(b);zm.plugins.uploadphoto.checkUploadFinished()};a.onerror=function(){zm.plugins.uploadphoto.loadImage(e,b,c,this.times)};setTimeout(function(){a.src=e},500*d)};zm.plugins.uploadphoto.updateText=function(b,a){if(!zm.isFunction(a.getNoteText)){return}var c="";if(b){c=a.getNoteText(0,b)}else{c=a.getNoteText(zm(a.container).find(".thumbContainer").find("li.photo_thumb").length,b)}zm(a.container).find(".photoNote").html(c)};zm.plugins.uploadphoto.showUploadFail=function(a){zm("#photopreview_"+a).html('<a href="#"><span class="stt_icosprt icosmldel photo" title="Xóa ảnh"></span><span class="stt_icosprt icowarning"></span></a>')};zm.plugins.uploadphoto.checkUploadFinished=function(){};zm.plugins.uploadphoto.delThumb=function(b,c){zm.plugins.uploadphoto.updateText(false,c);var d=zm(c.container).find(".thumbContainer"),a=d.find("li.photo_thumb").length;zm.plugins.uploadphoto.checkUploadFinished();!window.FormData&&zm.isFunction(c.setInputFilePosition)&&c.setInputFilePosition();zm.isFunction(c.onDeletePhoto)&&c.onDeletePhoto(b,a)};zm.plugins.uploadphoto.delAllThumbs=function(a){var b=[];zm(a.container).find(".thumbContainer .photo_thumb").each(function(){var c=zm(this).attr("data-pid");if(c){b.push(c)}});if(b.length>0&&a.getDeleteUrl){zm.post(a.getDeleteUrl(b),{pid:b.join(","),sign:zmConfig.signkey,ts:zmConfig.time},{dataType:"json"})}}});zm.install("dragdrop",{startDragDrop:function(i){if(!this[0]){return}var h=this[0];if(zm.data(h,"dragdrop.start")==true){return}zm.data(h,"dragdrop.start",true);var d=0,f,a,b,c=null,e={};this.children().each(function(){zm.data(this,"dragdrop.index",d);d++});f=function(){var j=this;if(j){while(j.parentNode!=h){j=j.parentNode;if(!j){return false}}c=j;zm(c).addClass("zme-dragging");i&&zm.isFunction(i.onDragging)&&i.onDragging.call(c)}return false};a=function(n){if(c){var m=this;while(m.parentNode!=h){m=m.parentNode;if(!m){return}}if(m!=c){var l=zm(h).children(),j=zm.inArray(c,l);for(var k=0,o;o=l[k];k++){if(o==m){if(k==l.size()-1){h.appendChild(c)}else{if(k>j){h.insertBefore(o,c)}else{h.insertBefore(c,o)}}break}}}if(zm.browser.msie&&n.button==0){if(m!=h){zm(c).removeClass("zme-dragging");i&&zm.isFunction(i.onStopDragging)&&i.onStopDragging.call(c);c=null}}}};b=function(){if(c){zm(c).removeClass("zme-dragging");i&&zm.isFunction(i.onStopDragging)&&i.onStopDragging.call(c)}c=null};e.mousedown=[this.mousedown(f),f];e.mousemove=[zm(document).mousemove(a),a];e.mouseup=[zm(document).mouseup(b),b];if(zm.browser.msie&&typeof h.onselectstart!="undefined"){var g=function(){return zm.data(h,"dragdrop.start")!=true};e.selectstart=[this.bind("selectstart",g),g]}zm.data(h,"dragdrop.events",e)},stopDragDrop:function(){var a=zm.data(this[0],"dragdrop.events");zm.each(a,function(c){this[0].unbind(c,this[1])});zm.removeData(this[0],"dragdrop.events");var b=this.getDragDropResult();zm.removeData(this[0],"dragdrop.start");return b},getDragDropResult:function(){if(zm.data(this[0],"dragdrop.start")){var b=new Array();for(var a=0,e;e=this.children()[a];a++){var d=zm.data(e,"dragdrop.index");b.push(d)}return b}return null}});zm.install("slideshow",{slideshow:function(p){p=zm.extend({},zm.plugins.slideshow.options,p);var j=this,k=j.children().outerWidth(true),a=Math.ceil(j.parent().width()/k),b=j.children().size(),n=b/a,e=0,h=0,f=false;var g=zm(p.nextSelector),d=zm(p.prevSelector),c=zm(p.pagerSelector);if(!p.disabledClass){f=true}else{f=false}if((g||d)&&!f){m()}j.children().css("position","relative");j.children().css("width",k);j.children().addClass("fl");j.css("position","absolute");j.css("left","0px");j.css("width",(b*k)+"px");j.css("transition","left "+p.speed+"ms ease");j.css("-webkit-transition","left "+p.speed+"ms ease");j.parent().css("position","relative");j.parent().css("overflow","hidden");zm(p.nextSelector+", "+p.prevSelector+", "+p.pagerSelector).hover(function(){p.auto=false},function(){p.auto=true});this.hover(function(){p.auto=false},function(){p.auto=true});if(g){g.click(function(){if(p.disabledClass&&!g.hasClass(p.disabledClass)){l()}else{if(!p.disabledClass){l()}}return false})}if(d){d.click(function(){if(p.disabledClass&&!d.hasClass(p.disabledClass)){i()}else{if(!p.disabledClass){i()}}return false})}if(c){c.click(function(){h=zm.intval(zm(this).text())-1;o(h);return false})}setInterval(function(){if(!j||!p.auto){return}if(p.pagerSelector){if(p.direction==="right"){if(h==n-1){h=0}else{h+=1}o(h)}else{if(h==0){h=n-1}else{h-=1}o(h)}}else{if(g&&p.direction==="right"){if(p.disabledClass&&!g.hasClass(p.disabledClass)){l()}else{if(!p.disabledClass){l()}}}else{if(d&&p.direction==="left"){if(p.disabledClass&&!d.hasClass(p.disabledClass)){i()}else{if(!p.disabledClass){i()}}}}}},p.pause);function l(){e+=p.jump;if(!f){m()}else{if(e>(b-a)){e=0}}j.css("left",-e*k+"px");if(zmCore.isFunction(p.onNext)&&zmCore.isFunction(p.onChange)){p.onNext(e);p.onChange(e)}}function i(){e-=p.jump;if(!f){m()}else{if(e<0){e=b-a}}j.css("left",-e*k+"px");if(zmCore.isFunction(p.onPrev&&zmCore.isFunction(p.onChange))){p.onPrev(e);p.onChange(e)}}function o(q){zm(p.pagerSelector+"."+p.selectedClass).removeClass(p.selectedClass);c.get(q).addClass(p.selectedClass);e=q*a;j.css("left",-e*k+"px");if(zmCore.isFunction(p.onChange)){p.onChange(e)}}function m(){if(!p.disabledClass){return}if(b<=a){if(d){d.addClass(p.disabledClass);d.css("visibility","hidden")}if(g){g.addClass(p.disabledClass);g.css("visibility","hidden")}}else{if(e<=0){g&&g.removeClass(p.disabledClass);d&&d.addClass(p.disabledClass)}else{if(e>=(b-a)){d&&d.removeClass(p.disabledClass);g&&g.addClass(p.disabledClass)}else{d&&d.removeClass(p.disabledClass);g&&g.removeClass(p.disabledClass)}}}}}},function(){zm.plugins.slideshow.options={jump:1,speed:1000,auto:true,direction:"right",pause:3000,onNext:function(){},onPrev:function(){},onChange:function(){}}});
