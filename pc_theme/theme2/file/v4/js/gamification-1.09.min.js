zm.ready(function(){function e(e){if(e<1)return 0;var t="";while(e>=1){if((t.length+1)%4==0)t="."+t;t=e%10+t;e=Math.floor(e/10)}return t}function i(e){switch(e.error){case-2:zm(document.getElementById("md-content")).html('<div style="margin: -5px 0 5px 5px;">Bạn cần đăng nhập để xem nội dung này.</div>');break}}function l(e,t){e.html(t).css({cursor:"pointer"});e.bind("click",function(){window.open("http://me.zing.vn/hlp/#detail?id=105")})}function h(e){clearTimeout(c);s.html(e);s.css("opacity",0);c=setTimeout(function(){s.show();s.css("opacity",1);c=setTimeout(function(){s.css("opacity",0);c=setTimeout(function(){s.hide()},500)},5e3)},500)}var t=function(e){var t=new zm.Boxy({content:e,footer:false,title:"Thông tin huy chương",boxyClass:"pu_large pu_medal"});t.show();return t};var n='<div class="zmsubbar">'+'<ul class="mtab"><li><a id="medal-normal-page" href="#medalinfo" class="selected">Huy chương Zing Me<span class="arrow zmsprt"></span></a></li>'+'<li><a id="medal-event-page" href="#medalinfo/evpage/2014">Huy chương sự kiện<span class="arrow zmsprt"></span></a></li></ul></div>'+'<div id="md-content"></div>',r=zm.createElement("div",{"class":"zmsubpage_wrapper"});r.innerHTML=n;window.zmMedal={curInfo:null,exs:false,showInfo:function(e){if(zmMedal.exs||!e)return;zmMedal.exs=true;zm.get("/zmd/v4/?medalid="+e,{dataType:"json"},function(e){if(e.error==0){zmMedal.curInfo=t(e.data)}zmMedal.exs=false},function(){zmMedal.exs=false})},share:function(e,t){try{this.curInfo.hide()}catch(n){}zm.get("/zmd/v4/shr/?medalid="+e+"&key="+t,{dataType:"json"},function(e){if(e.error==0){zm.Boxy.alert("Chia sẻ thành công","Thông báo")}else{zm.Boxy.alert("Có lỗi xảy ra, vui lòng thử lại sau.","Thông báo")}},function(){zm.Boxy.alert("Có lỗi xảy ra, vui lòng thử lại sau.","Thông báo")})},loadPage:function(e){if(!e){zm(document.getElementById("medal-event-page")).removeClass("selected");zm(document.getElementById("medal-normal-page")).addClass("selected");zm.get("/zmd/v4/mdpage?uid="+zmConfig.ownerId,function(e){if(e.indexOf('{"error"')<0)zm(document.getElementById("md-content")).html(e);else i(JSON.parse(e))})}else{zm(document.getElementById("medal-event-page")).addClass("selected");zm(document.getElementById("medal-normal-page")).removeClass("selected");zm.get("/zmd/v4/evpage?y="+e+"&uid="+zmConfig.ownerId,function(e){if(e.indexOf('{"error"')<0)zm(document.getElementById("md-content")).html(e);else i(JSON.parse(e))})}}};switch(zmConfig.pageName){case"profile":zm.get("/zmd/v4/?userid="+zmConfig.ownerId,{dataType:"json"},function(e){if(e.error==0){zm("#boxmedalcover").html(e.data);if(e.alert){var t=new zm.Boxy({content:e.alert,title:"Thông tin huy chương",boxyClass:"pu_large pu_medal",okButton:"Chia sẻ với bạn bè",onOk:function(){zmMedal.share(e.alertId,e.alertKey)}});t.show();zmMedal.curInfo=t}}});zmProfileTab.register(zmProfileTab.ID_MEDAL,["medalinfo","medalinfo/evpage/2013","medalinfo/evpage/2014"],function(e,t,n){if(!document.getElementById("medal-event-page")){t.empty().append(r);t.attr({id:"medal-page"}).addClass("zmpagecont")}if(n==="medalinfo"){zmMedal.loadPage()}else if(n.length>17&&n.substr(0,17)==="medalinfo/evpage/"){var i=parseInt(n.substr(17));zmMedal.loadPage(i)}});var s=zm(document.getElementById("user_money"));if(s&&s.length){if(!zmConfig.ownerType){zm.get("/api/money?uid="+zmConfig.ownerId,{dataType:"json"},function(t){if(t.error==0){var n=new zm.Template('<div class="zmcontbody"><span class="zmcoin_icon_x48"></span><div class="sum_money"><p>Tổng vàng: <strong class="money_number">{0}</strong></p><p><a href="{1}">Hướng dẫn cách kiếm vàng</a></p></div><div class="clr"></div></div>');s.html(n.render(e(t.amount)))}else s.hide()})}else{zm(document.getElementById("user_money")).hide()}}break;case"home":zm.get("/zmd/v4/al/",{dataType:"json"},function(e){if(e.error==0){zmMedal.curInfo=t(e.data)}});var o=zm.storage.get("event_worldcup:"+zmConfig.viewerId),u=+(new Date);if(!o){zm.storage.put("event_worldcup:"+zmConfig.viewerId,u,8e4);zm.get("/event/worldcup/popup",{dataType:"json"},function(e){if(e.error==0)zm.showSimpleViewer(e.data)})}break}var a=new zm.Template('<span class="lvgrp{5} icolevel"><em class="lvnum{0} lvnumtxt"></em></span><div class="level_popup"><div class="arrow"><em class="arrow_layer2"></em><em class="arrow_layer1"></em></div><div class="lvpu_inner"><p class="lvnumrow"><em class="lvnum{1} lvnumtxt target_lv"></em><em class="lvnum{0} lvnumtxt current_lv"></em></p><div class="lvprogressbar"><p class="totalbar"><span style="width:{4}%;" class="dynamicbar"></span></p></div></div><div class="exppoint"><span class="exptxt">Kinh nghiệm</span><strong class="cur_point">{2}</strong> / {3}</div></div></div>'),f={};zm.get("/api/level?uid="+zmConfig.viewerId,{dataType:"json"},function(e){if(e.error==0){f[zmConfig.viewerId]=a.render(e.level,e.level+1,e.exp,e.require,e.exp*100/e.require,parseInt(e.level/5)+1);zm("#user_level").each(function(e,t){var n=zm(t),r=n.attr("uid");if(!r)r=zmConfig.viewerId;if(f[r]){l(n,f[r])}else{zm.get("/api/level?uid="+r,{dataType:"json"},function(e){if(e.error==0){f[r]=a.render(e.level,e.level+1,e.exp,e.require,e.exp*100/e.require,parseInt(e.level/5)+1);l(n,f[r])}})}})}});var c=0,s=zm.createElement("div",{id:"floatMsg","class":"floatedmsg"},{display:"none"});zm(".zmviewport").prepend(s);s=zm(document.getElementById("floatMsg"));zmEvent.bind("gamification.msg",function(e){h(e.data)})})
