var zmimConfig={method:1,defaultMethod:4,onOff:1,useCookie:true,cookieDomain:".zing.vn",exclude:["email","password"],showControl:true};var zmim=(function(){var G={TELEX:1,VNI:2,AUTO:3,OFF:4},V={ALL:"SFRXJDAWEOZ",DAWEO:"DAWEO",SFRXJ:"SFRXJ",S:"S",F:"F",R:"R",X:"X",J:"J",D:"D",W:"W",A:"A",E:"E",O:"O",AW:"W",Z:"Z"},R={ALL:"1234567890",DAWEO:"6789",SFRXJ:"12345",S:"1",F:"2",R:"3",X:"4",J:"5",D:"9",W:"7",A:"6",E:"6",O:"6",AW:"8",Z:"0"};var Q=null,ai=null,r=false,Y=false,K=false;var U=[97,226,259,101,234,105,111,244,417,117,432,121,65,194,258,69,202,73,79,212,416,85,431,89],ab=[226,259,234,244,417,432,273,194,258,202,212,416,431,272],T=["a","a","a","e","e","i","o","o","o","u","u","y","A","A","A","E","E","I","O","O","O","U","U","Y"],aa=[225,7845,7855,233,7871,237,243,7889,7899,250,7913,253,193,7844,7854,201,7870,205,211,7888,7898,218,7912,221],X=[224,7847,7857,232,7873,236,242,7891,7901,249,7915,7923,192,7846,7856,200,7872,204,210,7890,7900,217,7914,7922],A=[7843,7849,7859,7867,7875,7881,7887,7893,7903,7911,7917,7927,7842,7848,7858,7866,7874,7880,7886,7892,7902,7910,7916,7926],e=[227,7851,7861,7869,7877,297,245,7895,7905,361,7919,7929,195,7850,7860,7868,7876,296,213,7894,7904,360,7918,7928],E=[7841,7853,7863,7865,7879,7883,7885,7897,7907,7909,7921,7925,7840,7852,7862,7864,7878,7882,7884,7896,7906,7908,7920,7924],b=[97,65,225,193,224,192,7843,7842,227,195,7841,7840],I=[259,258,7855,7854,7857,7856,7859,7858,7861,7860,7863,7862],N=[226,194,7845,7844,7847,7846,7849,7848,7851,7850,7853,7852],k=[111,79,243,211,242,210,7887,7886,245,213,7885,7884],x=[244,212,7889,7888,7891,7890,7893,7892,7895,7894,7897,7896],ak=[417,416,7899,7898,7901,7900,7903,7902,7905,7904,7907,7906],aj=[101,69,233,201,232,200,7867,7866,7869,7868,7865,7864],n=[234,202,7871,7870,7873,7872,7875,7874,7877,7876,7879,7878],M=[117,85,250,218,249,217,7911,7910,361,360,7909,7908],v=[432,431,7913,7912,7915,7914,7917,7916,7919,7818,7921,7920],m=[100,68],t=[273,272];var f=[],S,ag=[],u,Z;function p(){if(zmimConfig.useCookie){var am={expires:30};if(zmimConfig.cookieDomain){am.domain=zmimConfig.cookieDomain}zm.cookie("zm_InputMethod_On_Off",zmimConfig.onOff,am);zm.cookie("zm_InputMethod_Method",zmimConfig.method,am)}}function a(ap){var an,aq,am="",ao=1;an=ap.value;if(an.length<=0){return false}if(!ap.setSelectionRange){return false}aq=ap.selectionStart;if(ap.selectionStart!=ap.selectionEnd){return["",aq]}while(true){if(aq-ao<0){break}else{if(c(an.substr(aq-ao,1))){if(an.substr(aq-ao,1)=="\\"){am=an.substr(aq-ao,1)+am}break}else{am=an.substr(aq-ao,1)+am}}ao++}return[am,aq]}function O(an){var ao=an.document.selection.createRange(),am="";if(ao.text){ao.text=""}else{while(true){ao.moveStart("character",-1);if(am.length==ao.text.length){break}am=ao.text;if(c(am.charAt(0))){if(am.charCodeAt(0)==13){am=am.substr(2)}else{if(am.charAt(0)!="\\"){am=am.substr(1)}}break}}}if(am.length){ao.collapse(false);ao.moveStart("character",-am.length);an.cW=ao.duplicate();return an.cW.text}else{return false}}function c(am){var an=" \r\n#,\\;.:-_()<>+-*/=?!\"$%{}[]'~|^@&\t"+String.fromCharCode(160);return an.indexOf(am)>=0}function H(ao){if(typeof ao!=="string"){return false}var an="AEOUIY";ao=ao.toUpperCase();for(var am=0;am<an.length;am++){if(ao==an.charAt(am)){return true}}return false}function L(ao){if(typeof ao!=="string"){return false}var an="QRTPSDGHKLXCVBNM";ao=ao.toUpperCase();for(var am=0;am<an.length;am++){if(ao==an.charAt(am)){return true}}return false}function F(an,am){var ao;ai=an;am=String.fromCharCode(am);if(zm.browser.msie){ao=O(ai);if(ao){af(ao,am,0)}}else{ao=a(ai);if(ao){af(ao[0],am,ao[1])}}}function af(ar,ap,ao){var au=zmimConfig.method,an=ap.toUpperCase();if(au==G.AUTO){if(V.ALL.indexOf(an)>=0){Q=V}else{if(R.ALL.indexOf(an)>=0){Q=R}}}if(!Q){return}var at;if(Q.SFRXJ.indexOf(an)>=0){var aq=ah(an);at=o(ar,an,aq);g(ar,an,at,ao,U,ah(an))}else{if(an==Q.Z){at=o(ar,an);B(ar,at,ao)}else{if(Q.DAWEO.indexOf(an)>=0){var am=j(an);if(am){at=o(ar,an,am[1],am[0]);g(ar,an,at,ao,am[0],am[1])}}}}if(!c(ap)){y(ar,ap,ao)}}function o(aE,ao,ap,av){var az=aE.length,aB,aA;if(ao==Q.Z){var aD=d();for(aB=0;aB<aE.length;aB++){for(aA=0;aA<aD.length;aA++){if(aE.charCodeAt(aB)==aD[aA]){return[az-aB,W(aE.charAt(aB))]}}}for(aB=0;aB<aE.length;aB++){for(aA=0;aA<ab.length;aA++){if(aE.charCodeAt(aB)==ab[aA]){return[az-aB,ad(aE.charAt(aB))]}}}return false}var ay="",an=P(),aG=W(aE),aF=ad(aG);for(aB=0;aB<ap.length;aB++){if(isNaN(ap[aB])){ay+=ap[aB]}else{ay+=String.fromCharCode(ap[aB])}}var at=0,au=aF.charAt(az-1);if(H(au)){at=1}if(L(au)){at=2}if(at==0){return false}var ar="",aq;for(aB=0;aB<az;aB++){if(H(aF.charAt(aB))){var aw=aF.toLowerCase();if(aw.charAt(aB-1)!="g"||aw.charAt(aB)!="i"||aB==az-1){ar+=aE.charAt(aB)}}}aq=aE.indexOf(ar);if(aq==-1||ar.length>3){return false}var aC=ad(W(ar.toUpperCase()));if(!z(aC)){return false}if(Q.SFRXJ.indexOf(ao)>=0&&Q.SFRXJ.indexOf(au.toUpperCase())<0){if(ar.length==3){if(aC=="UYE"){aq+=2}else{aq++}}else{if(ar.length==2){if(aE.toUpperCase().indexOf("Q")==0||(at==2)||aC=="UE"||(aC=="IA"&&aE.toUpperCase().indexOf("G")==0)){aq++}}}for(aB=0;aB<ay.length;aB++){if(aG.charAt(aq)==an[aB]){if(aE.charAt(aq)==ay.charAt(aB)){return[az-aq,aG.charAt(aq)]}return az-aq}}}else{if(Q.DAWEO.indexOf(ao)>=0){var am="",ax;for(aB=0;aB<av.length;aB++){am+=String.fromCharCode(av[aB])}for(aB=0;aB<aE.length;aB++){for(aA=0;aA<ay.length;aA++){if(aE.charAt(0).toUpperCase()!="Q"&&aC.indexOf("UO")==0&&(ao==Q.W||ao==Q.O)){Y=true;return az-aq}if(aE.charAt(0).toUpperCase()=="Q"&&aC.indexOf("UO")==0){ax=aq+1}else{ax=aB}if(aE.charAt(ax)==ay.charAt(aA)){return[az-ax,i(aE.charAt(ax))]}if(aE.charAt(ax)==am.charAt(aA)){return az-ax}}}}}return false}function z(ao){var an=["AA","AE","EA","EE","EI","EY","OO","IO","II","IY","YA","YO","YU","YI","YY"];for(var am=0;am<an.length;am++){if(ao.indexOf(an[am])>=0){return false}}return true}function g(an,ar,au,at,aw,av){var ap=an.length,am,ao;if(au){if(au[1]){if(zm.browser.msie){q(an,au[0],au[1])}else{l(ai,at-au[0],au[1])}}else{if(Q.SFRXJ.indexOf(ar)>=0){ao=W(an).charCodeAt(ap-au)}else{ao=an.charCodeAt(ap-au)}for(var aq=0;aq<aw.length;aq++){if(ao==aw[aq]){am=av[aq];break}}if(Y){am=w(an.substr(ap-au,2),ar);Y=false}if(zm.browser.msie){q(an,au,am)}else{l(ai,at-au,am)}}}}function B(an,ao,am){if(ao){if(zm.browser.msie){q(an,ao[0],ao[1].charCodeAt(0))}else{l(ai,am-ao[0],ao[1].charCodeAt(0))}}}function y(an,aw,at){var ax=d(),ao=an.length,av,am,au=an+aw;for(var ar=0;ar<ao;ar++){for(var aq=0;aq<ax.length;aq++){if(an.charCodeAt(ar)==ax[aq]){av=o(au,Q.S,ah(Q.S));if(av&&!av[1]&&(ao+1-av)!=ar){am=String.fromCharCode(U[aq%24]);for(var ap=ar+1;ap<ao+1-av;ap++){am+=an.charAt(ap)}for(var ap=0;ap<24;ap++){if(au.charCodeAt(ao+1-av)==U[ap]){am+=String.fromCharCode(ax[aq-(aq%24)+ap]);break}}if((ao+1-av)==(au.length-1)){K=true}if(zm.browser.msie){q(an,ao-ar,am)}else{l(ai,at-ao+ar,am)}break}}}}}function W(ap){var ao=d();for(var an=0;an<ap.length;an++){for(var am=0;am<ao.length;am++){if(ap.charCodeAt(an)==ao[am]){ap=ap.substr(0,an)+String.fromCharCode(U[am%24])+ap.substr(an+1)}}}return ap}function ad(aq){var an=U.concat(t),am=T.concat(["d","D"]);for(var ap=0;ap<aq.length;ap++){for(var ao=0;ao<an.length;ao++){if(aq.charCodeAt(ap)==an[ao]){aq=aq.substr(0,ap)+am[ao]+aq.substr(ap+1)}}}return aq}function i(aq){var an=N.concat(I,x,ak,v,n,t),am=b.concat(b,k,k,M,aj,m);for(var ap=0;ap<aq.length;ap++){for(var ao=0;ao<an.length;ao++){if(aq.charCodeAt(ap)==an[ao]){aq=aq.substr(0,ap)+String.fromCharCode(am[ao])+aq.substr(ap+1)}}}return aq}function l(ap,ar,an){if(!an){return}var ao="",aq=ap.selectionStart,am=ap.scrollTop;if(isNaN(an)){ao=an}else{ao=String.fromCharCode(an);r=true}if(K){r=true;aq++;K=false}if(ao.length>0){ap.value=ap.value.substr(0,ar)+ao+ap.value.substr(ar+ao.length);ap.setSelectionRange(aq,aq);ap.scrollTop=am}}function q(ao,ap,am){if(!am){return}var an="";if(isNaN(am)){an=am}else{an=String.fromCharCode(am);r=true}if(K){r=true;K=false}ai.cW.text=ao.substr(0,ao.length-ap)+an+ao.substr(ao.length-ap+an.length)}function w(an,ar){var au,aq,ap,at="",ao,am;if(ar==Q.O){if(W(an.charAt(1).toUpperCase())==String.fromCharCode(212)){aq=M;au=k;r=false}else{aq=M;au=x;r=true}}else{if(ar==Q.W){if(W(an.toUpperCase())==String.fromCharCode(431,416)){aq=M;au=k;r=false}else{aq=v;au=ak;r=true}}}ao=i(an.charAt(0)).charCodeAt(0);for(ap=0;ap<aq.length;ap++){if(ao==M[ap]){at+=String.fromCharCode(aq[ap]);break}}am=i(an.charAt(1)).charCodeAt(0);for(ap=0;ap<au.length;ap++){if(am==k[ap]){at+=String.fromCharCode(au[ap]);break}}return at}function P(){var an=[];for(var am=0;am<U.length;am++){an[am]=String.fromCharCode(U[am])}return an}function ah(am){if(am==Q.S){return aa}else{if(am==Q.F){return X}else{if(am==Q.R){return A}else{if(am==Q.X){return e}else{if(am==Q.J){return E}}}}}return[]}function d(ap){var ao=[],am;for(var an=0;an<Q.SFRXJ.length;an++){am=Q.SFRXJ.charAt(an);if(!ap||am!=ap.toUpperCase()){ao=ao.concat(ah(am))}}return ao}function j(am){if(am==Q.D){return[m,t]}if(Q==V){if(am==Q.A){return[b.concat(I),N.concat(N)]}else{if(am==Q.E){return[aj,n]}else{if(am==Q.O){return[k.concat(ak),x.concat(x)]}else{if(am==Q.W||am==Q.AW){return[b.concat(N,k,x,M),I.concat(I,ak,ak,v)]}}}}}else{if(Q==R){if(am==Q.A||am==Q.E||am==Q.O){return[b.concat(I,aj,k,ak),N.concat(N,n,x,x)]}else{if(am==Q.W){return[k.concat(x,M),ak.concat(ak,v)]}else{if(am==Q.AW){return[b.concat(N),I.concat(I)]}}}}}}function D(an){for(var am=0;am<zmimConfig.exclude.length;am++){if(an.id==zmimConfig.exclude[am]){return true}}return false}function C(am){if(zmimConfig.onOff==0||zmimConfig.method==G.OFF||am==8){return false}return true}function ac(){if(Z){return}Z=true;zm("#impanel").append('<li>				<input id="imtelex" type="radio" id="chatvkey1" name="chatvkey" value="'+G.TELEX+'" />				<label for="chatvkey1"><span class="radio"></span>Telex</label>			</li>			<li>				<input id="imvni" type="radio" id="chatvkey2" name="chatvkey" value="'+G.VNI+'" />				<label for="chatvkey2"><span class="radio"></span>VNI</label>			</li>			<li>				<input id="imauto" type="radio" id="chatvkey3" name="chatvkey" value="'+G.AUTO+'" checked="checked" />				<label for="chatvkey3"><span class="radio"></span>Auto</label>			</li>			<li>				<input id="imoff" type="radio" id="chatvkey4" name="chatvkey" value="'+G.OFF+'" />				<label for="chatvkey4"><span class="radio"></span>Tắt bộ gõ</label>			</li>			<li>				<span id="iminfo" class="vkey_copyright_info"><em></em>Thông tin</span>			</li>')}function h(){var ao=zmimConfig.method;if(!zmimConfig.onOff){ao=G.OFF}zm('#impanel input[value="'+ao+'"]').attr("checked",true);zm("#imcontrol em")[ao==G.OFF?"addClass":"removeClass"]("disable_vkey");for(var am=0,an;an=ag[am];am++){zm(an)[ao==G.OFF?"addClass":"removeClass"]("icn_fonteng")}}function ae(){var am=zm.getViewport(),an=zm("#impanel");if(am.height+am.offsetY-zm("#imcontrol").top()>106){an.addClass("bottom")}else{an.removeClass("bottom")}an.show();zm("#imcontrol").parent().addClass("selected")}function al(){zm("#impanel").hide();zm("#imcontrol").parent().removeClass("selected")}function s(an){var am;if(an instanceof zmCore){am=an}else{am=zm(an||"#imcontrol")}am.unbindAll("click").click(function(){var ao=zm("#impanel");if(ao.is(":hidden")){ae(this)}else{al()}if(this.nodeName.toLowerCase()!="a"){zm(this).parent().focus()}return false}).mouseup(function(){var ao=this;setTimeout(function(){zm(ao).clickOutsideWith(zm("#impanel"))},200)},-1).blur(function(){!u&&al()}).attr("tabindex","0");if(S){return}S=true;zm("#impanel").on("click","li",function(){zmim.setMethod(zm(this).find("input").val());setTimeout(al,300)});zm("#impanel").hover(function(){u=true},function(){u=false});zm("#iminfo").click(function(){zm.Boxy.alert('<div>Bộ gõ tiếng Việt dành cho <strong>Zing Me</strong>. Được phát triển từ bộ gõ <strong>AVIM</strong>.<div>Hướng dẫn sử dụng:<ul style="margin-left: 10px;"><li>- F8: Thay đổi kiểu gõ</li><li>- F9: Tắt bộ gõ</li></ul></div>',"Bộ gõ tiếng Việt",null,{boxyClass:"pu_med"});al();return false})}function J(an){var am="Bộ gõ Tiếng Việt";if(an==G.AUTO){am+=" (Auto)"}else{if(an==G.OFF){am+=" (Đã tắt)"}else{if(an==G.TELEX){am+=" (Telex)"}else{if(an==G.VNI){am+=" (VNI)"}}}}return am}return{init:function(){ac();zm("#imcontrol").show();zmim.onSetMethod(function(ar){var aq=J(ar);zm("#imcontrol").attr("title",aq);for(var ao=0,ap;ap=ag[ao];ao++){zm(ap).attr("title",aq)}});setTimeout(function(){s();if(typeof zmChat!="undefined"){zmChat.onAttachButtons(s)}},1000);if(zmimConfig.useCookie){var am=zm.cookie("zm_InputMethod_Method");if(am===undefined){zmim.setMethod(zmimConfig.defaultMethod)}else{var an=zm.intval(zm.cookie("zm_InputMethod_Method"));if(zm.intval(zm.cookie("zm_InputMethod_On_Off"))===0){an=G.OFF}zmim.setMethod(an)}}zm(document).keypress(zmim.keypressHandler).keydown(zmim.keydownHandler)},setMethod:function(an){if(isNaN(an)||an>zm.objectLength(G)||an<1){return}zmimConfig.method=an;zmim.turn((an==G.OFF)?0:1);if(an==G.TELEX){Q=V}else{if(an==G.VNI){Q=R}else{Q=null}}for(var ao=0,am;am=f[ao];ao++){try{am(an)}catch(ap){}}},onSetMethod:function(am){if(!zm.isFunction(am)){return}if(zm.inArray(am,f)<0){f.push(am)}},turn:function(am){if(am>1){am=1}zmimConfig.onOff=am;p();zmimConfig.showControl&&h()},keypressHandler:function(ao){var an,am;if(zm.browser.msie){an=ao.srcElement;am=ao.keyCode}else{an=ao.target;am=ao.which}if(D(an)||ao.ctrlKey||ao.altKey){return}if((an.type!="textarea"&&an.type!="text")||!C(am)){return}F(an,am);if(r){r=false;ao.preventDefault();zm(this).change()}},keydownHandler:function(an){if(!zmim){return}var am;if(zm.browser.msie){am=an.keyCode}else{am=an.which}if(am==120){zmim.turn((zmimConfig.onOff===0)?1:0)}if(am==119){var ao=zmimConfig.method+1;ao=(ao>zm.objectLength(G))?1:ao;zmim.setMethod(ao)}},attachButton:function(am,an){if(!am){return}ac();an=an||am;zm(an)[zmimConfig.onOff?"removeClass":"addClass"]("icn_fonteng").attr("title",J(zmimConfig.method));if(zm.inArray(an,ag)==-1){ag.push(an)}s(am)}}})();zm.ready(zmim.init,1);
